(()=>{"use strict";var e={n:n=>{var t=n&&n.__esModule?()=>n.default:()=>n;return e.d(t,{a:t}),t},d:(n,t)=>{for(var i in t)e.o(t,i)&&!e.o(n,i)&&Object.defineProperty(n,i,{enumerable:!0,get:t[i]})},o:(e,n)=>Object.prototype.hasOwnProperty.call(e,n)};const n=window.React,t=window.wp.element,i=window.wp.apiFetch;var s=e.n(i);const r=window.ReactJSXRuntime,o=({label:e,children:n})=>(0,r.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,r.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500"},children:e}),n]}),d=e=>(0,r.jsx)("input",{type:"text",...e,style:{width:"100%",padding:"8px",border:"1px solid #ddd"}}),a=e=>(0,r.jsx)("textarea",{...e,style:{width:"100%",padding:"8px",border:"1px solid #ddd",minHeight:"100px"}}),l=({children:e,...n})=>(0,r.jsx)("select",{...n,style:{width:"100%",padding:"8px",border:"1px solid #ddd"},children:e}),c=({children:e,...n})=>(0,r.jsx)("button",{...n,style:{padding:"10px 15px",border:"none",backgroundColor:"#2271b1",color:"white",borderRadius:"3px",cursor:"pointer"},children:e}),p=()=>{const{apiUrl:e,nonce:t}=window.quizExtendedData,i={question_title:"",question_description:"",question_type:"multiple_choice",question_mark:1,options:[{answer_title:"",is_correct:!1},{answer_title:"",is_correct:!1}],difficulty:"medium",category:"general",theme:"default",approval_status:"pending"},[p,x]=(0,n.useState)(i),[h,u]=(0,n.useState)({message:"",type:"info"}),[g,m]=(0,n.useState)(!1),[j,y]=(0,n.useState)([]),[b,f]=(0,n.useState)("Pendiente de prueba.");(0,n.useEffect)(()=>{},[]);const v=e=>x(n=>({...n,[e.target.name]:e.target.value}));return(0,r.jsxs)("div",{style:{margin:"20px",fontFamily:"sans-serif"},children:[(0,r.jsxs)("div",{style:{padding:"20px",backgroundColor:"#fff",border:"1px solid #e5e5e5",marginBottom:"20px"},children:[(0,r.jsx)("h3",{children:"Diagnóstico de Conexión"}),(0,r.jsx)(c,{onClick:()=>{f("Probando conexión con la API de Tutor..."),s()({path:"/quiz-extended/v1/test-tutor-connection"}).then(e=>{f(`Respuesta: ${e.message} (Código: ${e.status_code})`),console.log("Respuesta del test:",e)}).catch(e=>{f(`Error en la conexión: ${e.message}`),console.error("Error en el test:",e)})},children:"Probar Conexión a Tutor API"}),(0,r.jsxs)("p",{style:{fontFamily:"monospace",marginTop:"10px"},children:[(0,r.jsx)("strong",{children:"Estado de la Conexión:"})," ",b]})]}),(0,r.jsxs)("div",{style:{display:"flex",gap:"20px"},children:[(0,r.jsxs)("div",{style:{flex:3,backgroundColor:"white",padding:"20px",border:"1px solid #e5e5e5"},children:[(0,r.jsx)("h2",{children:"Pregunta"}),(0,r.jsx)(o,{label:"Enunciado de la Pregunta *",children:(0,r.jsx)(d,{name:"question_title",value:p.question_title,onChange:v,maxLength:"200"})}),(0,r.jsxs)(o,{label:"Opciones de Respuesta",children:[p.options.map((e,n)=>(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"10px"},children:[(0,r.jsx)("input",{type:"radio",name:"correct_answer",checked:e.is_correct,onChange:()=>(e=>{const n=p.options.map((n,t)=>({...n,is_correct:t===e}));x(e=>({...e,options:n}))})(n),style:{marginRight:"10px"}}),(0,r.jsx)(d,{value:e.answer_title,onChange:e=>((e,n)=>{const t=[...p.options];t[e].answer_title=n,x(e=>({...e,options:t}))})(n,e.target.value),placeholder:`Opción ${String.fromCharCode(65+n)}`})]},n)),(0,r.jsx)("button",{onClick:()=>x(e=>({...e,options:[...e.options,{answer_title:"",is_correct:!1}]})),style:{border:"none",background:"none",color:"#2271b1",cursor:"pointer"},children:"+ Añadir Opción"})]}),(0,r.jsx)(o,{label:"Explicación / Retroalimentación (Opcional)",children:(0,r.jsx)(a,{name:"question_description",value:p.question_description,onChange:v,maxLength:"1000"})})]}),(0,r.jsxs)("div",{style:{flex:1,backgroundColor:"white",padding:"20px",border:"1px solid #e5e5e5"},children:[(0,r.jsx)("h3",{children:"Configuración"}),(0,r.jsx)(o,{label:"Dificultad:",children:(0,r.jsxs)(l,{name:"difficulty",value:p.difficulty,onChange:v,children:[(0,r.jsx)("option",{value:"easy",children:"Fácil"}),(0,r.jsx)("option",{value:"medium",children:"Media"}),(0,r.jsx)("option",{value:"hard",children:"Difícil"})]})}),(0,r.jsx)(o,{label:"Categoría:",children:(0,r.jsxs)(l,{name:"category",value:p.category,onChange:v,children:[(0,r.jsx)("option",{value:"history",children:"Historia"}),(0,r.jsx)("option",{value:"science",children:"Ciencia"})]})}),(0,r.jsx)(o,{label:"Tema:",children:(0,r.jsxs)(l,{name:"theme",value:p.theme,onChange:v,children:[(0,r.jsx)("option",{value:"ww2",children:"Segunda Guerra Mundial"}),(0,r.jsx)("option",{value:"biology",children:"Biología"})]})}),(0,r.jsx)(o,{label:"Estado:",children:(0,r.jsxs)(l,{name:"approval_status",value:p.approval_status,onChange:v,children:[(0,r.jsx)("option",{value:"pending",children:"Pendiente"}),(0,r.jsx)("option",{value:"approved",children:"Aprobada"})]})})]})]}),(0,r.jsxs)("div",{style:{marginTop:"20px",padding:"15px",backgroundColor:"white",border:"1px solid #e5e5e5",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[h.message&&(0,r.jsx)("p",{style:{margin:0,color:"error"===h.type?"red":"green"},children:h.message}),(0,r.jsx)(c,{onClick:()=>{m(!0),u({message:"Guardando pregunta...",type:"info"});const e={...p,correct_answer:p.options.find(e=>e.is_correct)?.answer_title||""};s()({path:"/quiz-extended/v1/questions",method:"POST",data:e,headers:{"X-WP-Nonce":t}}).then(e=>{if(!e.success)throw new Error(e.message||"Ocurrió un error desconocido.");u({message:e.message,type:"success"}),x(i)}).catch(e=>u({message:`Error: ${e.message}`,type:"error"})).finally(()=>m(!1))},disabled:g,children:g?"Guardando...":"Guardar Pregunta"})]}),(0,r.jsxs)("div",{style:{marginTop:"40px"},children:[(0,r.jsx)("h2",{children:"Banco de Preguntas Guardadas"}),(0,r.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",backgroundColor:"white"},children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{style:{borderBottom:"1px solid #e5e5e5",textAlign:"left"},children:[(0,r.jsx)("th",{style:{padding:"10px"},children:"ID Tutor (Simulado)"}),(0,r.jsx)("th",{style:{padding:"10px"},children:"Dificultad"}),(0,r.jsx)("th",{style:{padding:"10px"},children:"Categoría"}),(0,r.jsx)("th",{style:{padding:"10px"},children:"Tema"}),(0,r.jsx)("th",{style:{padding:"10px"},children:"Estado"})]})}),(0,r.jsx)("tbody",{children:j.length>0?j.map(e=>(0,r.jsxs)("tr",{style:{borderBottom:"1px solid #f0f0f0"},children:[(0,r.jsx)("td",{style:{padding:"10px"},children:e.tutor_question_id}),(0,r.jsx)("td",{style:{padding:"10px"},children:e.difficulty}),(0,r.jsx)("td",{style:{padding:"10px"},children:e.category}),(0,r.jsx)("td",{style:{padding:"10px"},children:e.theme}),(0,r.jsx)("td",{style:{padding:"10px"},children:e.approval_status})]},e.meta_id)):(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:"5",style:{padding:"20px",textAlign:"center"},children:"No hay preguntas en el banco todavía."})})})]})]})]})},x=document.getElementById("quiz-extended-react-admin-app");x&&(0,t.render)((0,r.jsx)(p,{}),x)})();