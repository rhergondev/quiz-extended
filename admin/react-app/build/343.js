"use strict";(globalThis.webpackChunkquiz_extended=globalThis.webpackChunkquiz_extended||[]).push([[343],{6343:(e,r,o)=>{o.d(r,{enrollUserInCourse:()=>d,getUserEnrollments:()=>u,unenrollUserFromCourse:()=>N});var n=o(5236),s=o(9700);const t={NETWORK:"NETWORK_ERROR",API:"API_ERROR",VALIDATION:"VALIDATION_ERROR",AUTH:"AUTH_ERROR",NOT_FOUND:"NOT_FOUND",PERMISSION:"PERMISSION_ERROR",TIMEOUT:"TIMEOUT_ERROR",UNKNOWN:"UNKNOWN_ERROR"},i=e=>{const r=e.message?.toLowerCase()||"";return r.includes("network")||r.includes("fetch")?t.NETWORK:r.includes("404")?t.NOT_FOUND:r.includes("401")||r.includes("unauthorized")?t.AUTH:r.includes("403")||r.includes("forbidden")?t.PERMISSION:r.includes("validation")?t.VALIDATION:r.includes("timeout")?t.TIMEOUT:r.includes("api error")?t.API:t.UNKNOWN},a=(e,r)=>{const o={[t.NETWORK]:"Network error. Please check your connection.",[t.API]:"Server error. Please try again later.",[t.VALIDATION]:"Invalid data provided.",[t.AUTH]:"Authentication required. Please log in.",[t.NOT_FOUND]:"Resource not found.",[t.PERMISSION]:"You do not have permission to perform this action.",[t.TIMEOUT]:"Request timeout. Please try again.",[t.UNKNOWN]:"An unexpected error occurred."};return o[e]||o[t.UNKNOWN]},l=(e,r={})=>{const o=((e,r={})=>{const o=i(e);return{type:o,message:e.message,userMessage:a(o),originalError:e,context:r,timestamp:(new Date).toISOString(),stack:void 0}})(e,r);console.error("ðŸ”´ Error:",{type:o.type,message:o.message,context:o.context,timestamp:o.timestamp})},c=async(e,r={})=>{const{maxRetries:o=3,retryDelay:n=1e3,shouldRetry:s=e=>{const r=i(e);return r===t.NETWORK||r===t.TIMEOUT}}=r;let a;for(let r=0;r<=o;r++)try{return await e()}catch(e){if(a=e,r===o)break;if(!s(e))throw e;console.warn(`âš ï¸ Retry attempt ${r+1}/${o}`,e.message),await new Promise(e=>setTimeout(e,n*(r+1)))}throw l(a,{maxRetries:o,apiCall:e.name}),a},u=async e=>{try{if(!e||!Number.isInteger(e)||e<=0)throw new Error("Valid user ID is required");const r=(0,n.getApiConfig)(),o=`${r.apiUrl}/qe/v1/users/${e}/enrollments`;console.log(`ðŸ“š Fetching enrollments for user ${e}...`);const t=await(0,s.qb)(o,{method:"GET",headers:{"Content-Type":"application/json","X-WP-Nonce":r.nonce},credentials:"same-origin"}),i=t.data?.data||t.data;return console.log(`âœ… Fetched ${Array.isArray(i)?i.length:0} enrollments for user ${e}`),Array.isArray(i)?i:[]}catch(r){return console.error(`âŒ Error fetching user enrollments for user ${e}:`,r),c(r,t.FETCH)}},d=async(e,r)=>{try{if(!e||!Number.isInteger(e)||e<=0)throw new Error("Valid user ID is required");if(!r||!Number.isInteger(r)||r<=0)throw new Error("Valid course ID is required");const o=(0,n.getApiConfig)(),t=`${o.apiUrl}/qe/v1/users/${e}/enrollments`;console.log(`âž• Enrolling user ${e} in course ${r}...`);const i=await(0,s.qb)(t,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":o.nonce},credentials:"same-origin",body:JSON.stringify({course_id:r})});return console.log(`âœ… User ${e} successfully enrolled in course ${r}`),i.data}catch(o){return console.error(`âŒ Error enrolling user ${e} in course ${r}:`,o),c(o,t.CREATE)}},N=async(e,r)=>{try{if(!e||!Number.isInteger(e)||e<=0)throw new Error("Valid user ID is required");if(!r||!Number.isInteger(r)||r<=0)throw new Error("Valid course ID is required");const o=(0,n.getApiConfig)(),t=`${o.apiUrl}/qe/v1/users/${e}/enrollments/${r}`;console.log(`âž– Unenrolling user ${e} from course ${r}...`);const i=await(0,s.qb)(t,{method:"DELETE",headers:{"Content-Type":"application/json","X-WP-Nonce":o.nonce},credentials:"same-origin"});return console.log(`âœ… User ${e} successfully unenrolled from course ${r}`),i.data}catch(o){return console.error(`âŒ Error unenrolling user ${e} from course ${r}:`,o),c(o,t.DELETE)}}}}]);