(()=>{"use strict";var e={338:(e,t,s)=>{var r=s(795);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},795:e=>{e.exports=window.ReactDOM}},t={};function s(r){var a=t[r];if(void 0!==a)return a.exports;var n=t[r]={exports:{}};return e[r](n,n.exports,s),n.exports}s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);const r=window.React;var a=s.n(r),n=s(338),l="popstate";function o(e={}){return function(e,t,s,r={}){let{window:a=document.defaultView,v5Compat:n=!1}=r,o=a.history,c="POP",h=null,p=x();function x(){return(o.state||{idx:null}).idx}function g(){c="POP";let e=x(),t=null==e?null:e-p;p=e,h&&h({action:c,location:y.location,delta:t})}function f(e){return function(e,t=!1){let s="http://localhost";"undefined"!=typeof window&&(s="null"!==window.location.origin?window.location.origin:window.location.href),i(s,"No window.location.(origin|href) available to create URL");let r="string"==typeof e?e:m(e);return r=r.replace(/ $/,"%20"),!t&&r.startsWith("//")&&(r=s+r),new URL(r,s)}(e)}null==p&&(p=0,o.replaceState({...o.state,idx:p},""));let y={get action(){return c},get location(){return e(a,o)},listen(e){if(h)throw new Error("A history only accepts one active listener");return a.addEventListener(l,g),h=e,()=>{a.removeEventListener(l,g),h=null}},createHref:e=>t(a,e),createURL:f,encodeLocation(e){let t=f(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){c="PUSH";let r=d(y.location,e,t);s&&s(r,e),p=x()+1;let l=u(r,p),i=y.createHref(r);try{o.pushState(l,"",i)}catch(e){if(e instanceof DOMException&&"DataCloneError"===e.name)throw e;a.location.assign(i)}n&&h&&h({action:c,location:y.location,delta:1})},replace:function(e,t){c="REPLACE";let r=d(y.location,e,t);s&&s(r,e),p=x();let a=u(r,p),l=y.createHref(r);o.replaceState(a,"",l),n&&h&&h({action:c,location:y.location,delta:0})},go:e=>o.go(e)};return y}(function(e,t){let{pathname:s="/",search:r="",hash:a=""}=h(e.location.hash.substring(1));return s.startsWith("/")||s.startsWith(".")||(s="/"+s),d("",{pathname:s,search:r,hash:a},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){let s=e.document.querySelector("base"),r="";if(s&&s.getAttribute("href")){let t=e.location.href,s=t.indexOf("#");r=-1===s?t:t.slice(0,s)}return r+"#"+("string"==typeof t?t:m(t))},function(e,t){c("/"===e.pathname.charAt(0),`relative pathnames are not supported in hash history.push(${JSON.stringify(t)})`)},e)}function i(e,t){if(!1===e||null==e)throw new Error(t)}function c(e,t){if(!e){"undefined"!=typeof console&&console.warn(t);try{throw new Error(t)}catch(e){}}}function u(e,t){return{usr:e.state,key:e.key,idx:t}}function d(e,t,s=null,r){return{pathname:"string"==typeof e?e:e.pathname,search:"",hash:"",..."string"==typeof t?h(t):t,state:s,key:t&&t.key||r||Math.random().toString(36).substring(2,10)}}function m({pathname:e="/",search:t="",hash:s=""}){return t&&"?"!==t&&(e+="?"===t.charAt(0)?t:"?"+t),s&&"#"!==s&&(e+="#"===s.charAt(0)?s:"#"+s),e}function h(e){let t={};if(e){let s=e.indexOf("#");s>=0&&(t.hash=e.substring(s),e=e.substring(0,s));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function p(e,t,s="/"){return function(e,t,s,r){let a=E(("string"==typeof t?h(t):t).pathname||"/",s);if(null==a)return null;let n=x(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){return e.length===t.length&&e.slice(0,-1).every((e,s)=>e===t[s])?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(n);let l=null;for(let e=0;null==l&&e<n.length;++e){let t=S(a);l=k(n[e],t,r)}return l}(e,t,s,!1)}function x(e,t=[],s=[],r="",a=!1){let n=(e,n,l=a,o)=>{let c={relativePath:void 0===o?e.path||"":o,caseSensitive:!0===e.caseSensitive,childrenIndex:n,route:e};if(c.relativePath.startsWith("/")){if(!c.relativePath.startsWith(r)&&l)return;i(c.relativePath.startsWith(r),`Absolute route path "${c.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),c.relativePath=c.relativePath.slice(r.length)}let u=z([r,c.relativePath]),d=s.concat(c);e.children&&e.children.length>0&&(i(!0!==e.index,`Index routes must not have child routes. Please remove all child routes from route path "${u}".`),x(e.children,t,d,u,l)),(null!=e.path||e.index)&&t.push({path:u,score:C(u,e.index),routesMeta:d})};return e.forEach((e,t)=>{if(""!==e.path&&e.path?.includes("?"))for(let s of g(e.path))n(e,t,!0,s);else n(e,t)}),t}function g(e){let t=e.split("/");if(0===t.length)return[];let[s,...r]=t,a=s.endsWith("?"),n=s.replace(/\?$/,"");if(0===r.length)return a?[n,""]:[n];let l=g(r.join("/")),o=[];return o.push(...l.map(e=>""===e?n:[n,e].join("/"))),a&&o.push(...l),o.map(t=>e.startsWith("/")&&""===t?"/":t)}new WeakMap;var f=/^:[\w-]+$/,y=3,b=2,v=1,w=10,j=-2,N=e=>"*"===e;function C(e,t){let s=e.split("/"),r=s.length;return s.some(N)&&(r+=j),t&&(r+=b),s.filter(e=>!N(e)).reduce((e,t)=>e+(f.test(t)?y:""===t?v:w),r)}function k(e,t,s=!1){let{routesMeta:r}=e,a={},n="/",l=[];for(let e=0;e<r.length;++e){let o=r[e],i=e===r.length-1,c="/"===n?t:t.slice(n.length)||"/",u=_({path:o.relativePath,caseSensitive:o.caseSensitive,end:i},c),d=o.route;if(!u&&i&&s&&!r[r.length-1].route.index&&(u=_({path:o.relativePath,caseSensitive:o.caseSensitive,end:!1},c)),!u)return null;Object.assign(a,u.params),l.push({params:a,pathname:z([n,u.pathname]),pathnameBase:P(z([n,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(n=z([n,u.pathnameBase]))}return l}function _(e,t){"string"==typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[s,r]=function(e,t=!1,s=!0){c("*"===e||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,s)=>(r.push({paramName:t,isOptional:null!=s}),s?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(r.push({paramName:"*"}),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),r]}(e.path,e.caseSensitive,e.end),a=t.match(s);if(!a)return null;let n=a[0],l=n.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:r.reduce((e,{paramName:t,isOptional:s},r)=>{if("*"===t){let e=o[r]||"";l=n.slice(0,n.length-e.length).replace(/(.)\/+$/,"$1")}const a=o[r];return e[t]=s&&!a?void 0:(a||"").replace(/%2F/g,"/"),e},{}),pathname:n,pathnameBase:l,pattern:e}}function S(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return c(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function E(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let s=t.endsWith("/")?t.length-1:t.length,r=e.charAt(s);return r&&"/"!==r?null:e.slice(s)||"/"}function $(e,t,s,r){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${s}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function M(e){let t=function(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}(e);return t.map((e,s)=>s===t.length-1?e.pathname:e.pathnameBase)}function q(e,t,s,r=!1){let a;"string"==typeof e?a=h(e):(a={...e},i(!a.pathname||!a.pathname.includes("?"),$("?","pathname","search",a)),i(!a.pathname||!a.pathname.includes("#"),$("#","pathname","hash",a)),i(!a.search||!a.search.includes("#"),$("#","search","hash",a)));let n,l=""===e||""===a.pathname,o=l?"/":a.pathname;if(null==o)n=s;else{let e=t.length-1;if(!r&&o.startsWith("..")){let t=o.split("/");for(;".."===t[0];)t.shift(),e-=1;a.pathname=t.join("/")}n=e>=0?t[e]:"/"}let c=function(e,t="/"){let{pathname:s,search:r="",hash:a=""}="string"==typeof e?h(e):e,n=s?s.startsWith("/")?s:function(e,t){let s=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?s.length>1&&s.pop():"."!==e&&s.push(e)}),s.length>1?s.join("/"):"/"}(s,t):t;return{pathname:n,search:R(r),hash:T(a)}}(a,n),u=o&&"/"!==o&&o.endsWith("/"),d=(l||"."===o)&&s.endsWith("/");return c.pathname.endsWith("/")||!u&&!d||(c.pathname+="/"),c}var z=e=>e.join("/").replace(/\/\/+/g,"/"),P=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),R=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",T=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";function L(e){return null!=e&&"number"==typeof e.status&&"string"==typeof e.statusText&&"boolean"==typeof e.internal&&"data"in e}var D=["POST","PUT","PATCH","DELETE"],A=(new Set(D),["GET",...D]);new Set(A),Symbol("ResetLoaderData");var F=r.createContext(null);F.displayName="DataRouter";var I=r.createContext(null);I.displayName="DataRouterState";r.createContext(!1);var U=r.createContext({isTransitioning:!1});U.displayName="ViewTransition",r.createContext(new Map).displayName="Fetchers",r.createContext(null).displayName="Await";var O=r.createContext(null);O.displayName="Navigation";var Q=r.createContext(null);Q.displayName="Location";var W=r.createContext({outlet:null,matches:[],isDataRoute:!1});W.displayName="Route";var B=r.createContext(null);function V(){return null!=r.useContext(Q)}function H(){return i(V(),"useLocation() may be used only in the context of a <Router> component."),r.useContext(Q).location}B.displayName="RouteError";var J="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function X(e){r.useContext(O).static||r.useLayoutEffect(e)}function Y(){let{isDataRoute:e}=r.useContext(W);return e?function(){let{router:e}=function(e){let t=r.useContext(F);return i(t,re(e)),t}("useNavigate"),t=ae("useNavigate"),s=r.useRef(!1);return X(()=>{s.current=!0}),r.useCallback(async(r,a={})=>{c(s.current,J),s.current&&("number"==typeof r?e.navigate(r):await e.navigate(r,{fromRouteId:t,...a}))},[e,t])}():function(){i(V(),"useNavigate() may be used only in the context of a <Router> component.");let e=r.useContext(F),{basename:t,navigator:s}=r.useContext(O),{matches:a}=r.useContext(W),{pathname:n}=H(),l=JSON.stringify(M(a)),o=r.useRef(!1);return X(()=>{o.current=!0}),r.useCallback((r,a={})=>{if(c(o.current,J),!o.current)return;if("number"==typeof r)return void s.go(r);let i=q(r,JSON.parse(l),n,"path"===a.relative);null==e&&"/"!==t&&(i.pathname="/"===i.pathname?t:z([t,i.pathname])),(a.replace?s.replace:s.push)(i,a.state,a)},[t,s,l,n,e])}()}function K(e,{relative:t}={}){let{matches:s}=r.useContext(W),{pathname:a}=H(),n=JSON.stringify(M(s));return r.useMemo(()=>q(e,JSON.parse(n),a,"path"===t),[e,n,a,t])}function G(e,t,s,a,n){i(V(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=r.useContext(O),{matches:o}=r.useContext(W),u=o[o.length-1],d=u?u.params:{},m=u?u.pathname:"/",x=u?u.pathnameBase:"/",g=u&&u.route;{let e=g&&g.path||"";le(m,!g||e.endsWith("*")||e.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${m}" (under <Route path="${e}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="${e}"> to <Route path="${"/"===e?"*":`${e}/*`}">.`)}let f,y=H();if(t){let e="string"==typeof t?h(t):t;i("/"===x||e.pathname?.startsWith(x),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${x}" but pathname "${e.pathname}" was given in the \`location\` prop.`),f=e}else f=y;let b=f.pathname||"/",v=b;if("/"!==x){let e=x.replace(/^\//,"").split("/");v="/"+b.replace(/^\//,"").split("/").slice(e.length).join("/")}let w=p(e,{pathname:v});c(g||null!=w,`No routes matched location "${f.pathname}${f.search}${f.hash}" `),c(null==w||void 0!==w[w.length-1].route.element||void 0!==w[w.length-1].route.Component||void 0!==w[w.length-1].route.lazy,`Matched leaf route at location "${f.pathname}${f.search}${f.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let j=function(e,t=[],s=null,a=null){if(null==e){if(!s)return null;if(s.errors)e=s.matches;else{if(0!==t.length||s.initialized||!(s.matches.length>0))return null;e=s.matches}}let n=e,l=s?.errors;if(null!=l){let e=n.findIndex(e=>e.route.id&&void 0!==l?.[e.route.id]);i(e>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),n=n.slice(0,Math.min(n.length,e+1))}let o=!1,c=-1;if(s)for(let e=0;e<n.length;e++){let t=n[e];if((t.route.HydrateFallback||t.route.hydrateFallbackElement)&&(c=e),t.route.id){let{loaderData:e,errors:r}=s,a=t.route.loader&&!e.hasOwnProperty(t.route.id)&&(!r||void 0===r[t.route.id]);if(t.route.lazy||a){o=!0,n=c>=0?n.slice(0,c+1):[n[0]];break}}}return n.reduceRight((e,i,u)=>{let d,m=!1,h=null,p=null;s&&(d=l&&i.route.id?l[i.route.id]:void 0,h=i.route.errorElement||ee,o&&(c<0&&0===u?(le("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),m=!0,p=null):c===u&&(m=!0,p=i.route.hydrateFallbackElement||null)));let x=t.concat(n.slice(0,u+1)),g=()=>{let t;return t=d?h:m?p:i.route.Component?r.createElement(i.route.Component,null):i.route.element?i.route.element:e,r.createElement(se,{match:i,routeContext:{outlet:e,matches:x,isDataRoute:null!=s},children:t})};return s&&(i.route.ErrorBoundary||i.route.errorElement||0===u)?r.createElement(te,{location:s.location,revalidation:s.revalidation,component:h,error:d,children:g(),routeContext:{outlet:null,matches:x,isDataRoute:!0},unstable_onError:a}):g()},null)}(w&&w.map(e=>Object.assign({},e,{params:Object.assign({},d,e.params),pathname:z([x,l.encodeLocation?l.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?x:z([x,l.encodeLocation?l.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),o,s,a,n);return t&&j?r.createElement(Q.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...f},navigationType:"POP"}},j):j}function Z(){let e=function(){let e=r.useContext(B),t=function(e){let t=r.useContext(I);return i(t,re(e)),t}("useRouteError"),s=ae("useRouteError");return void 0!==e?e:t.errors?.[s]}(),t=L(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),s=e instanceof Error?e.stack:null,a="rgba(200,200,200, 0.5)",n={padding:"0.5rem",backgroundColor:a},l={padding:"2px 4px",backgroundColor:a},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=r.createElement(r.Fragment,null,r.createElement("p",null,"💿 Hey developer 👋"),r.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",r.createElement("code",{style:l},"ErrorBoundary")," or"," ",r.createElement("code",{style:l},"errorElement")," prop on your route.")),r.createElement(r.Fragment,null,r.createElement("h2",null,"Unexpected Application Error!"),r.createElement("h3",{style:{fontStyle:"italic"}},t),s?r.createElement("pre",{style:n},s):null,o)}r.createContext(null);var ee=r.createElement(Z,null),te=class extends r.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error("React Router caught the following error during render",e)}render(){return void 0!==this.state.error?r.createElement(W.Provider,{value:this.props.routeContext},r.createElement(B.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function se({routeContext:e,match:t,children:s}){let a=r.useContext(F);return a&&a.static&&a.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=t.route.id),r.createElement(W.Provider,{value:e},s)}function re(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ae(e){let t=function(e){let t=r.useContext(W);return i(t,re(e)),t}(e),s=t.matches[t.matches.length-1];return i(s.route.id,`${e} can only be used on routes that contain a unique "id"`),s.route.id}var ne={};function le(e,t,s){t||ne[e]||(ne[e]=!0,c(!1,s))}function oe({to:e,replace:t,state:s,relative:a}){i(V(),"<Navigate> may be used only in the context of a <Router> component.");let{static:n}=r.useContext(O);c(!n,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=r.useContext(W),{pathname:o}=H(),u=Y(),d=q(e,M(l),o,"path"===a),m=JSON.stringify(d);return r.useEffect(()=>{u(JSON.parse(m),{replace:t,state:s,relative:a})},[u,m,a,t,s]),null}function ie(e){i(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function ce({basename:e="/",children:t=null,location:s,navigationType:a="POP",navigator:n,static:l=!1}){i(!V(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=e.replace(/^\/*/,"/"),u=r.useMemo(()=>({basename:o,navigator:n,static:l,future:{}}),[o,n,l]);"string"==typeof s&&(s=h(s));let{pathname:d="/",search:m="",hash:p="",state:x=null,key:g="default"}=s,f=r.useMemo(()=>{let e=E(d,o);return null==e?null:{location:{pathname:e,search:m,hash:p,state:x,key:g},navigationType:a}},[o,d,m,p,x,g,a]);return c(null!=f,`<Router basename="${o}"> is not able to match the URL "${d}${m}${p}" because it does not start with the basename, so the <Router> won't render anything.`),null==f?null:r.createElement(O.Provider,{value:u},r.createElement(Q.Provider,{children:t,value:f}))}function ue({children:e,location:t}){return G(de(e),t)}function de(e,t=[]){let s=[];return r.Children.forEach(e,(e,a)=>{if(!r.isValidElement(e))return;let n=[...t,a];if(e.type===r.Fragment)return void s.push.apply(s,de(e.props.children,n));i(e.type===ie,`[${"string"==typeof e.type?e.type:e.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),i(!e.props.index||!e.props.children,"An index route cannot have child routes.");let l={id:e.props.id||n.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:!0===e.props.hasErrorBoundary||null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(l.children=de(e.props.children,n)),s.push(l)}),s}r.memo(function({routes:e,future:t,state:s,unstable_onError:r}){return G(e,void 0,s,r,t)}),r.Component;var me="get",he="application/x-www-form-urlencoded";function pe(e){return null!=e&&"string"==typeof e.tagName}var xe=null,ge=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function fe(e){return null==e||ge.has(e)?e:(c(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${he}"`),null)}function ye(e,t){if(!1===e||null==e)throw new Error(t)}function be(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"==typeof e.imageSrcSet&&"string"==typeof e.imageSizes:"string"==typeof e.rel&&"string"==typeof e.href)}function ve(e,t,s,r,a,n){let l=(e,t)=>!s[t]||e.route.id!==s[t].route.id,o=(e,t)=>s[t].pathname!==e.pathname||s[t].route.path?.endsWith("*")&&s[t].params["*"]!==e.params["*"];return"assets"===n?t.filter((e,t)=>l(e,t)||o(e,t)):"data"===n?t.filter((t,n)=>{let i=r.routes[t.route.id];if(!i||!i.hasLoader)return!1;if(l(t,n)||o(t,n))return!0;if(t.route.shouldRevalidate){let r=t.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:s[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"==typeof r)return r}return!0}):[]}function we(e,t,{includeHydrateFallback:s}={}){return r=e.map(e=>{let r=t.routes[e.route.id];if(!r)return[];let a=[r.module];return r.clientActionModule&&(a=a.concat(r.clientActionModule)),r.clientLoaderModule&&(a=a.concat(r.clientLoaderModule)),s&&r.hydrateFallbackModule&&(a=a.concat(r.hydrateFallbackModule)),r.imports&&(a=a.concat(r.imports)),a}).flat(1),[...new Set(r)];var r}function je(){let e=r.useContext(F);return ye(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function Ne(){let e=r.useContext(I);return ye(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}Object.getOwnPropertyNames(Object.prototype).sort().join("\0"),"undefined"!=typeof window?window:"undefined"!=typeof globalThis&&globalThis,Symbol("SingleFetchRedirect");var Ce=r.createContext(void 0);function ke(){let e=r.useContext(Ce);return ye(e,"You must render this element inside a <HydratedRouter> element"),e}function _e(e,t){return s=>{e&&e(s),s.defaultPrevented||t(s)}}function Se({page:e,...t}){let{router:s}=je(),a=r.useMemo(()=>p(s.routes,e,s.basename),[s.routes,e,s.basename]);return a?r.createElement($e,{page:e,matches:a,...t}):null}function Ee(e){let{manifest:t,routeModules:s}=ke(),[a,n]=r.useState([]);return r.useEffect(()=>{let r=!1;return async function(e,t,s){return function(e,t){let s=new Set,r=new Set(t);return e.reduce((e,a)=>{if(t&&(null==(n=a)||"string"!=typeof n.page)&&"script"===a.as&&a.href&&r.has(a.href))return e;var n;let l=JSON.stringify(function(e){let t={},s=Object.keys(e).sort();for(let r of s)t[r]=e[r];return t}(a));return s.has(l)||(s.add(l),e.push({key:l,link:a})),e},[])}((await Promise.all(e.map(async e=>{let r=t.routes[e.route.id];if(r){let e=await async function(e,t){if(e.id in t)return t[e.id];try{let s=await import(e.module);return t[e.id]=s,s}catch(t){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}(r,s);return e.links?e.links():[]}return[]}))).flat(1).filter(be).filter(e=>"stylesheet"===e.rel||"preload"===e.rel).map(e=>"stylesheet"===e.rel?{...e,rel:"prefetch",as:"style"}:{...e,rel:"prefetch"}))}(e,t,s).then(e=>{r||n(e)}),()=>{r=!0}},[e,t,s]),a}function $e({page:e,matches:t,...s}){let a=H(),{manifest:n,routeModules:l}=ke(),{basename:o}=je(),{loaderData:i,matches:c}=Ne(),u=r.useMemo(()=>ve(e,t,c,n,a,"data"),[e,t,c,n,a]),d=r.useMemo(()=>ve(e,t,c,n,a,"assets"),[e,t,c,n,a]),m=r.useMemo(()=>{if(e===a.pathname+a.search+a.hash)return[];let s=new Set,r=!1;if(t.forEach(e=>{let t=n.routes[e.route.id];t&&t.hasLoader&&(!u.some(t=>t.route.id===e.route.id)&&e.route.id in i&&l[e.route.id]?.shouldRevalidate||t.hasClientLoader?r=!0:s.add(e.route.id))}),0===s.size)return[];let c=function(e,t,s){let r="string"==typeof e?new URL(e,"undefined"==typeof window?"server://singlefetch/":window.location.origin):e;return"/"===r.pathname?r.pathname=`_root.${s}`:t&&"/"===E(r.pathname,t)?r.pathname=`${t.replace(/\/$/,"")}/_root.${s}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${s}`,r}(e,o,"data");return r&&s.size>0&&c.searchParams.set("_routes",t.filter(e=>s.has(e.route.id)).map(e=>e.route.id).join(",")),[c.pathname+c.search]},[o,i,a,n,u,t,e,l]),h=r.useMemo(()=>we(d,n),[d,n]),p=Ee(d);return r.createElement(r.Fragment,null,m.map(e=>r.createElement("link",{key:e,rel:"prefetch",as:"fetch",href:e,...s})),h.map(e=>r.createElement("link",{key:e,rel:"modulepreload",href:e,...s})),p.map(({key:e,link:t})=>r.createElement("link",{key:e,nonce:s.nonce,...t})))}Ce.displayName="FrameworkContext";function Me(...e){return t=>{e.forEach(e=>{"function"==typeof e?e(t):null!=e&&(e.current=t)})}}r.Component;var qe="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;try{qe&&(window.__reactRouterVersion="7.8.2")}catch(e){}function ze({basename:e,children:t,window:s}){let a=r.useRef();null==a.current&&(a.current=o({window:s,v5Compat:!0}));let n=a.current,[l,i]=r.useState({action:n.action,location:n.location}),c=r.useCallback(e=>{r.startTransition(()=>i(e))},[i]);return r.useLayoutEffect(()=>n.listen(c),[n,c]),r.createElement(ce,{basename:e,children:t,location:l.location,navigationType:l.action,navigator:n})}var Pe=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Re=r.forwardRef(function({onClick:e,discover:t="render",prefetch:s="none",relative:a,reloadDocument:n,replace:l,state:o,target:u,to:d,preventScrollReset:h,viewTransition:p,...x},g){let f,{basename:y}=r.useContext(O),b="string"==typeof d&&Pe.test(d),v=!1;if("string"==typeof d&&b&&(f=d,qe))try{let e=new URL(window.location.href),t=d.startsWith("//")?new URL(e.protocol+d):new URL(d),s=E(t.pathname,y);t.origin===e.origin&&null!=s?d=s+t.search+t.hash:v=!0}catch(e){c(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let w=function(e,{relative:t}={}){i(V(),"useHref() may be used only in the context of a <Router> component.");let{basename:s,navigator:a}=r.useContext(O),{hash:n,pathname:l,search:o}=K(e,{relative:t}),c=l;return"/"!==s&&(c="/"===l?s:z([s,l])),a.createHref({pathname:c,search:o,hash:n})}(d,{relative:a}),[j,N,C]=function(e,t){let s=r.useContext(Ce),[a,n]=r.useState(!1),[l,o]=r.useState(!1),{onFocus:i,onBlur:c,onMouseEnter:u,onMouseLeave:d,onTouchStart:m}=t,h=r.useRef(null);r.useEffect(()=>{if("render"===e&&o(!0),"viewport"===e){let e=new IntersectionObserver(e=>{e.forEach(e=>{o(e.isIntersecting)})},{threshold:.5});return h.current&&e.observe(h.current),()=>{e.disconnect()}}},[e]),r.useEffect(()=>{if(a){let e=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(e)}}},[a]);let p=()=>{n(!0)},x=()=>{n(!1),o(!1)};return s?"intent"!==e?[l,h,{}]:[l,h,{onFocus:_e(i,p),onBlur:_e(c,x),onMouseEnter:_e(u,p),onMouseLeave:_e(d,x),onTouchStart:_e(m,p)}]:[!1,h,{}]}(s,x),k=function(e,{target:t,replace:s,state:a,preventScrollReset:n,relative:l,viewTransition:o}={}){let i=Y(),c=H(),u=K(e,{relative:l});return r.useCallback(r=>{if(function(e,t){return!(0!==e.button||t&&"_self"!==t||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e))}(r,t)){r.preventDefault();let t=void 0!==s?s:m(c)===m(u);i(e,{replace:t,state:a,preventScrollReset:n,relative:l,viewTransition:o})}},[c,i,u,s,a,t,e,n,l,o])}(d,{replace:l,state:o,target:u,preventScrollReset:h,relative:a,viewTransition:p}),_=r.createElement("a",{...x,...C,href:f||w,onClick:v||n?e:function(t){e&&e(t),t.defaultPrevented||k(t)},ref:Me(g,N),target:u,"data-discover":b||"render"!==t?void 0:"true"});return j&&!b?r.createElement(r.Fragment,null,_,r.createElement(Se,{page:w})):_});function Te(e){let t=r.useContext(F);return i(t,function(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}(e)),t}Re.displayName="Link",r.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:s="",end:a=!1,style:n,to:l,viewTransition:o,children:c,...u},d){let m=K(l,{relative:u.relative}),h=H(),p=r.useContext(I),{navigator:x,basename:g}=r.useContext(O),f=null!=p&&function(e,{relative:t}={}){let s=r.useContext(U);i(null!=s,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:a}=Te("useViewTransitionState"),n=K(e,{relative:t});if(!s.isTransitioning)return!1;let l=E(s.currentLocation.pathname,a)||s.currentLocation.pathname,o=E(s.nextLocation.pathname,a)||s.nextLocation.pathname;return null!=_(n.pathname,o)||null!=_(n.pathname,l)}(m)&&!0===o,y=x.encodeLocation?x.encodeLocation(m).pathname:m.pathname,b=h.pathname,v=p&&p.navigation&&p.navigation.location?p.navigation.location.pathname:null;t||(b=b.toLowerCase(),v=v?v.toLowerCase():null,y=y.toLowerCase()),v&&g&&(v=E(v,g)||v);const w="/"!==y&&y.endsWith("/")?y.length-1:y.length;let j,N=b===y||!a&&b.startsWith(y)&&"/"===b.charAt(w),C=null!=v&&(v===y||!a&&v.startsWith(y)&&"/"===v.charAt(y.length)),k={isActive:N,isPending:C,isTransitioning:f},S=N?e:void 0;j="function"==typeof s?s(k):[s,N?"active":null,C?"pending":null,f?"transitioning":null].filter(Boolean).join(" ");let $="function"==typeof n?n(k):n;return r.createElement(Re,{...u,"aria-current":S,className:j,ref:d,style:$,to:l,viewTransition:o},"function"==typeof c?c(k):c)}).displayName="NavLink",r.forwardRef(({discover:e="render",fetcherKey:t,navigate:s,reloadDocument:a,replace:n,state:l,method:o=me,action:c,onSubmit:u,relative:d,preventScrollReset:h,viewTransition:p,...x},g)=>{let f=function(){let{router:e}=Te("useSubmit"),{basename:t}=r.useContext(O),s=ae("useRouteId");return r.useCallback(async(r,a={})=>{let{action:n,method:l,encType:o,formData:i,body:c}=function(e,t){let s,r,a,n,l;if(pe(o=e)&&"form"===o.tagName.toLowerCase()){let l=e.getAttribute("action");r=l?E(l,t):null,s=e.getAttribute("method")||me,a=fe(e.getAttribute("enctype"))||he,n=new FormData(e)}else if(function(e){return pe(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return pe(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let l=e.form;if(null==l)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let o=e.getAttribute("formaction")||l.getAttribute("action");if(r=o?E(o,t):null,s=e.getAttribute("formmethod")||l.getAttribute("method")||me,a=fe(e.getAttribute("formenctype"))||fe(l.getAttribute("enctype"))||he,n=new FormData(l,e),!function(){if(null===xe)try{new FormData(document.createElement("form"),0),xe=!1}catch(e){xe=!0}return xe}()){let{name:t,type:s,value:r}=e;if("image"===s){let e=t?`${t}.`:"";n.append(`${e}x`,"0"),n.append(`${e}y`,"0")}else t&&n.append(t,r)}}else{if(pe(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');s=me,r=null,a=he,l=e}var o;return n&&"text/plain"===a&&(l=n,n=void 0),{action:r,method:s.toLowerCase(),encType:a,formData:n,body:l}}(r,t);if(!1===a.navigate){let t=a.fetcherKey||De();await e.fetch(t,s,a.action||n,{preventScrollReset:a.preventScrollReset,formData:i,body:c,formMethod:a.method||l,formEncType:a.encType||o,flushSync:a.flushSync})}else await e.navigate(a.action||n,{preventScrollReset:a.preventScrollReset,formData:i,body:c,formMethod:a.method||l,formEncType:a.encType||o,replace:a.replace,state:a.state,fromRouteId:s,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,t,s])}(),y=function(e,{relative:t}={}){let{basename:s}=r.useContext(O),a=r.useContext(W);i(a,"useFormAction must be used inside a RouteContext");let[n]=a.matches.slice(-1),l={...K(e||".",{relative:t})},o=H();if(null==e){l.search=o.search;let e=new URLSearchParams(l.search),t=e.getAll("index");if(t.some(e=>""===e)){e.delete("index"),t.filter(e=>e).forEach(t=>e.append("index",t));let s=e.toString();l.search=s?`?${s}`:""}}return e&&"."!==e||!n.route.index||(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),"/"!==s&&(l.pathname="/"===l.pathname?s:z([s,l.pathname])),m(l)}(c,{relative:d}),b="get"===o.toLowerCase()?"get":"post",v="string"==typeof c&&Pe.test(c);return r.createElement("form",{ref:g,method:b,action:y,onSubmit:a?u:e=>{if(u&&u(e),e.defaultPrevented)return;e.preventDefault();let r=e.nativeEvent.submitter,a=r?.getAttribute("formmethod")||o;f(r||e.currentTarget,{fetcherKey:t,method:a,navigate:s,replace:n,state:l,relative:d,preventScrollReset:h,viewTransition:p})},...x,"data-discover":v||"render"!==e?void 0:"true"})}).displayName="Form";var Le=0,De=()=>`__${String(++Le)}__`;const Ae=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},Fe=(...e)=>e.filter((e,t,s)=>Boolean(e)&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim(),Ie=e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var Ue={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Oe=(0,r.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:n="",children:l,iconNode:o,...i},c)=>(0,r.createElement)("svg",{ref:c,...Ue,width:t,height:t,stroke:e,strokeWidth:a?24*Number(s)/Number(t):s,className:Fe("lucide",n),...!l&&!Ie(i)&&{"aria-hidden":"true"},...i},[...o.map(([e,t])=>(0,r.createElement)(e,t)),...Array.isArray(l)?l:[l]])),Qe=(e,t)=>{const s=(0,r.forwardRef)(({className:s,...a},n)=>{return(0,r.createElement)(Oe,{ref:n,iconNode:t,className:Fe(`lucide-${l=Ae(e),l.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,s),...a});var l});return s.displayName=Ae(e),s},We=Qe("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]),Be=Qe("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),Ve=Qe("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]),He=Qe("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Je=Qe("trophy",[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]]),Xe=Qe("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),Ye=Qe("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Ke=Qe("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),Ge=()=>{const e=window.qe_data||window.qeApiConfig||{},{api_url:t,nonce:s,endpoints:r}=e;if(console.log("🔍 API Config Debug:",{hasQeData:!!window.qe_data,hasQeApiConfig:!!window.qeApiConfig,apiUrl:t,hasNonce:!!s,hasEndpoints:!!r}),!t||!s)throw new Error(`WordPress API configuration not found. \n      Ensure qe_data is properly localized in WordPress. \n      Available data: ${JSON.stringify(e,null,2)}`);const a={apiUrl:t,nonce:s,endpoints:r||{courses:`${t}/wp/v2/course`,lessons:`${t}/wp/v2/lesson`,quizzes:`${t}/wp/v2/quiz`,questions:`${t}/wp/v2/question`,books:`${t}/wp/v2/book`,categories:`${t}/wp/v2/qe_category`,topics:`${t}/wp/v2/qe_topic`,difficulties:`${t}/wp/v2/qe_difficulty`,courseTypes:`${t}/wp/v2/course_type`,media:`${t}/wp/v2/media`,users:`${t}/wp/v2/users`},debug:e.debug||!1,user:e.user||null};return console.log("✅ Final API Configuration:",a),a},Ze=(e={})=>{const{type:t=null,category:s=null,status:a=null,search:n="",autoFetch:l=!0,initialFilters:o={},debounceMs:i=500}=e,[c,u]=(0,r.useState)([]),[d,m]=(0,r.useState)(!0),[h,p]=(0,r.useState)(!1),[x,g]=(0,r.useState)(null),[f,y]=(0,r.useState)({currentPage:1,totalPages:1,total:0,perPage:20}),[b,v]=(0,r.useState)(!1),[w,j]=(0,r.useState)({search:n||"",type:t,category:s,status:a||"publish,draft,private",...o}),N=(0,r.useRef)(w),C=(0,r.useRef)(e),k=(0,r.useRef)(null),_=(0,r.useRef)(!0),S=(0,r.useRef)("");(0,r.useEffect)(()=>{N.current=w},[w]),(0,r.useEffect)(()=>{C.current=e},[e]),(0,r.useEffect)(()=>()=>{_.current=!1,k.current&&clearTimeout(k.current)},[]);const E=async(e,t={})=>{try{const s={headers:{"Content-Type":"application/json","X-WP-Nonce":Ge().nonce},credentials:"same-origin",...t},r=await fetch(e,s);if(!r.ok){const e=await r.text();throw new Error(`API Error ${r.status}: ${r.statusText} - ${e}`)}return r}catch(e){throw console.error("API Request Error:",e),e}},$=(0,r.useCallback)(async(e={})=>{const{reset:t=!1,page:s=1,additionalFilters:r={}}=e;try{t&&(m(!0),g(null));const e=Ge(),a=N.current,n=new URLSearchParams({page:s.toString(),per_page:"20",status:a.status||"publish,draft",orderby:"date",order:"desc",_embed:"true"});a.search&&n.append("search",a.search),a.type&&n.append("course_type",a.type),a.category&&n.append("categories",a.category),Object.entries(r).forEach(([e,t])=>{null!=t&&""!==t&&n.append(e,t)});const l=`${e.endpoints.courses}?${n}`,o=`${l}-${s}-${t}`;if(o===S.current)return void console.log("🚫 Duplicate course request prevented:",l);S.current=o,console.log("🚀 Fetching courses:",l);const i=await E(l),c=await i.json();if(!_.current)return;const d=i.headers.get("X-WP-Total"),h=i.headers.get("X-WP-TotalPages"),p={currentPage:s,totalPages:h?parseInt(h,10):1,total:d?parseInt(d,10):c.length,perPage:20};y(p),v(s<p.totalPages),u(t||1===s?c:e=>{const t=new Set(e.map(e=>e.id)),s=c.filter(e=>!t.has(e.id));return[...e,...s]}),console.log("✅ Courses loaded:",c.length)}catch(e){console.error("❌ Error fetching courses:",e),_.current&&(g(e.message||"Failed to fetch courses"),(t||1===s)&&(u([]),y({currentPage:1,totalPages:1,total:0,perPage:20}),v(!1)))}finally{_.current&&m(!1)}},[]),M=(0,r.useCallback)((e={})=>{k.current&&clearTimeout(k.current),k.current=setTimeout(()=>{_.current&&$({reset:!0,...e})},i)},[$,i]);(0,r.useEffect)(()=>{l&&(console.log("🎯 Initial course load"),$({reset:!0}))},[]),(0,r.useEffect)(()=>{j(e=>{const r={...e,search:n||"",type:t,category:s,status:a||e.status};return JSON.stringify(r)!==JSON.stringify(e)?r:e})},[n,t,s,a]),(0,r.useEffect)(()=>{l&&(console.log("🔄 Course filters changed, debouncing fetch..."),M())},[w,M,l]);const q=(0,r.useCallback)(async e=>{try{p(!0),g(null);const t=Ge(),s={title:e.title||"",content:e.content||"",excerpt:e.excerpt||"",status:e.status||"draft",meta:{_course_price:e.price||"0",_course_duration:e.duration||"",_course_difficulty:e.difficulty||"beginner",_course_instructor:e.instructor||"",_course_max_students:e.maxStudents||"0",_course_requirements:e.requirements||"",_course_outcomes:e.outcomes||"",_course_featured:e.featured?"yes":"no",...e.meta},course_type:e.typeId?[e.typeId]:[],categories:e.categoryIds||[],featured_media:e.featuredImageId||0};console.log("🚀 Creating course:",s);const r=await E(t.endpoints.courses,{method:"POST",body:JSON.stringify(s)}),a=await r.json();return u(e=>[a,...e]),y(e=>({...e,total:e.total+1})),console.log("✅ Course created:",a),a}catch(e){throw console.error("❌ Error creating course:",e),g(e.message||"Failed to create course"),e}finally{p(!1)}},[]),z=(0,r.useCallback)(async e=>{try{g(null);const t=Ge();console.log("🗑️ Deleting course:",e),await E(`${t.endpoints.courses}/${e}`,{method:"DELETE"}),u(t=>t.filter(t=>t.id!==e)),y(e=>({...e,total:Math.max(0,e.total-1)})),console.log("✅ Course deleted")}catch(e){throw console.error("❌ Error deleting course:",e),g(e.message||"Failed to delete course"),e}},[]),P=(0,r.useCallback)(async e=>{try{g(null);const t=c.find(t=>t.id===e);if(!t)throw new Error("Course not found");const s={title:`${t.title?.rendered||t.title} (Copy)`,content:t.content?.rendered||t.content||"",excerpt:t.excerpt?.rendered||t.excerpt||"",status:"draft",price:t.meta?._course_price,duration:t.meta?._course_duration,difficulty:t.meta?._course_difficulty,instructor:t.meta?._course_instructor,maxStudents:t.meta?._course_max_students,requirements:t.meta?._course_requirements,outcomes:t.meta?._course_outcomes,featured:"yes"===t.meta?._course_featured,typeId:t.course_type?.[0],categoryIds:t.categories||[],meta:t.meta};return console.log("📋 Duplicating course:",e),await q(s)}catch(e){throw console.error("❌ Error duplicating course:",e),g(e.message||"Failed to duplicate course"),e}},[c,q]),R=(0,r.useCallback)(()=>{b&&!d&&$({page:f.currentPage+1,reset:!1})},[b,d,f.currentPage,$]),T=(0,r.useCallback)(()=>{S.current="",$({reset:!0})},[$]),L=(0,r.useMemo)(()=>({totalCourses:c.length,publishedCourses:c.filter(e=>"publish"===e.status).length,draftCourses:c.filter(e=>"draft"===e.status).length,privateCourses:c.filter(e=>"private"===e.status).length,coursesByType:c.reduce((e,t)=>((t.course_type||[]).forEach(t=>{e[t]=(e[t]||0)+1}),e),{}),coursesByDifficulty:c.reduce((e,t)=>{const s=t.meta?._course_difficulty||"beginner";return e[s]=(e[s]||0)+1,e},{}),averagePrice:c.length>0?Math.round(c.reduce((e,t)=>e+parseFloat(t.meta?._course_price||"0"),0)/c.length):0,totalRevenue:c.reduce((e,t)=>e+parseFloat(t.meta?._course_price||"0"),0),freeCourses:c.filter(e=>0===parseFloat(e.meta?._course_price||"0")).length,paidCourses:c.filter(e=>parseFloat(e.meta?._course_price||"0")>0).length,featuredCourses:c.filter(e=>"yes"===e.meta?._course_featured).length,coursesWithInstructor:c.filter(e=>e.meta?._course_instructor&&""!==e.meta._course_instructor.trim()).length,averageDuration:c.length>0?Math.round(c.reduce((e,t)=>{const s=t.meta?._course_duration||"";return e+(parseFloat(s)||0)},0)/c.length):0,totalStudents:c.reduce((e,t)=>e+parseInt(t.meta?._course_max_students||"0"),0)}),[c]);return{courses:c,loading:d,creating:h,error:x,pagination:f,hasMore:b,filters:w,computed:L,createCourse:q,deleteCourse:z,duplicateCourse:P,refreshCourses:T,loadMoreCourses:R,fetchCourses:M}},et=Qe("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),tt=Qe("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),st=Qe("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),rt=Qe("award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]),at=Qe("tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]),nt=Qe("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),lt=Qe("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),ot=Qe("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),it=Qe("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),ct=Qe("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]),ut=window.ReactJSXRuntime,dt=({item:e,viewMode:t="cards",actions:s=[],children:n,className:l="",header:o,footer:i,onClick:c,clickable:u=!1})=>{const[d,m]=(0,r.useState)(!1),h="bg-white border border-gray-200 transition-shadow "+(u?"cursor-pointer hover:shadow-lg":"shadow-sm hover:shadow-md"),p="cards"===t?"rounded-lg p-6":"rounded-md p-4 flex items-center space-x-4";return(0,ut.jsxs)("div",{className:`${h} ${p} ${l}`,onClick:t=>{t.target.closest(".dropdown-menu")||t.target.closest(".dropdown-trigger")||c&&u&&c(e)},children:[o&&(0,ut.jsx)("div",{className:"mb-4",children:o}),(0,ut.jsx)("div",{className:"list"===t?"flex-1":"",children:n}),i&&(0,ut.jsx)("div",{className:"mt-4",children:i}),s.length>0&&(0,ut.jsxs)("div",{className:"relative",children:[(0,ut.jsx)("button",{onClick:e=>{e.stopPropagation(),m(!d)},className:"dropdown-trigger p-2 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100",children:(0,ut.jsx)(ct,{className:"h-5 w-5"})}),d&&(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>m(!1)}),(0,ut.jsx)("div",{className:"dropdown-menu absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg border border-gray-200 z-20",children:(0,ut.jsx)("div",{className:"py-1",children:s.map((t,s)=>(0,ut.jsxs)(a().Fragment,{children:[(0,ut.jsxs)("button",{onClick:s=>((t,s)=>{s.stopPropagation(),m(!1),t.onClick&&t.onClick(e)})(t,s),className:`w-full text-left px-4 py-2 text-sm flex items-center space-x-2 hover:bg-gray-50 ${t.color||"text-gray-700"}`,children:[t.icon&&(0,ut.jsx)(t.icon,{className:"h-4 w-4"}),(0,ut.jsx)("span",{children:t.label})]}),t.divider&&(0,ut.jsx)("div",{className:"border-t border-gray-100 my-1"})]},s))})})]})]})]})},mt=({course:e,viewMode:t="cards",onEdit:s,onDelete:r,onDuplicate:a,onClick:n,showPrice:l=!0,showStats:o=!0,className:i=""})=>{const c=parseFloat(e.meta?._course_price||"0"),u=parseFloat(e.meta?._sale_price||"0"),d=e.meta?._course_category,m=e.meta?._course_difficulty||"beginner",h=e.meta?._course_duration||"",p=e.meta?._course_instructor||"",x=parseInt(e.meta?._course_max_students||"0"),g="yes"===e.meta?._course_featured,f=parseInt(e.meta?._enrolled_students||"0"),y=e=>{switch(e){case"publish":return"text-green-600 bg-green-100";case"draft":return"text-yellow-600 bg-yellow-100";case"private":default:return"text-gray-600 bg-gray-100";case"pending":return"text-blue-600 bg-blue-100"}},b=e=>{switch(e){case"beginner":return"text-green-600 bg-green-100";case"intermediate":return"text-yellow-600 bg-yellow-100";case"advanced":return"text-orange-600 bg-orange-100";case"expert":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},v=e=>e?new Date(e).toLocaleDateString():"N/A",w=(e,t)=>0===e?"Free":t>0&&t<e?(0,ut.jsxs)("span",{children:[(0,ut.jsxs)("span",{className:"line-through text-gray-400",children:["$",e]}),(0,ut.jsxs)("span",{className:"ml-1 text-green-600",children:["$",t]})]}):`$${e}`,j=[{label:"Edit",icon:et,onClick:s,color:"text-blue-600"},{label:"Duplicate",icon:tt,onClick:a,color:"text-green-600"},{label:"Delete",icon:st,onClick:r,color:"text-red-600"}].filter(e=>e.onClick);return(0,ut.jsx)(dt,{item:e,viewMode:t,actions:j,className:i,clickable:!!n,onClick:n,children:"cards"===t?(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsx)("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${y(e.status)}`,children:e.status}),g&&(0,ut.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium text-yellow-600 bg-yellow-100",children:[(0,ut.jsx)(Xe,{className:"h-3 w-3 mr-1"}),"Featured"]})]}),l&&(0,ut.jsx)("div",{className:"text-lg font-semibold text-gray-900",children:w(c,u)})]}),(0,ut.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2 line-clamp-2",children:e.title?.rendered||e.title||"Untitled Course"}),e.excerpt&&(0,ut.jsx)("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:e.excerpt.rendered||e.excerpt}),(0,ut.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[m&&(0,ut.jsxs)("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${b(m)}`,children:[(0,ut.jsx)(rt,{className:"h-3 w-3 mr-1"}),m]}),d&&(0,ut.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium text-gray-600 bg-gray-100",children:[(0,ut.jsx)(at,{className:"h-3 w-3 mr-1"}),d]})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[h&&(0,ut.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,ut.jsx)(nt,{className:"h-4 w-4"}),(0,ut.jsxs)("span",{children:[h,"h"]})]}),p&&(0,ut.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,ut.jsx)(lt,{className:"h-4 w-4"}),(0,ut.jsx)("span",{className:"truncate",children:p})]})]}),o&&(0,ut.jsx)("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:x>0&&(0,ut.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,ut.jsx)(ot,{className:"h-4 w-4"}),(0,ut.jsxs)("span",{children:[f,"/",x," students"]})]})})]}),(0,ut.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-400 pt-3 border-t border-gray-100",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,ut.jsx)(it,{className:"h-3 w-3"}),(0,ut.jsxs)("span",{children:["Updated ",v(e.modified)]})]}),(0,ut.jsxs)("span",{children:["ID: ",e.id]})]})]}):(0,ut.jsxs)("div",{className:"flex items-center w-full",children:[(0,ut.jsx)("div",{className:"flex-shrink-0 mr-4",children:(0,ut.jsx)("div",{className:"h-12 w-12 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,ut.jsx)(We,{className:"h-6 w-6 text-blue-600"})})}),(0,ut.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ut.jsx)("h3",{className:"text-lg font-semibold text-gray-900 truncate",children:e.title?.rendered||e.title||"Untitled Course"}),(0,ut.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[g&&(0,ut.jsx)(Xe,{className:"h-4 w-4 text-yellow-500"}),m&&(0,ut.jsx)("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${b(m)}`,children:m}),(0,ut.jsx)("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${y(e.status)}`,children:e.status})]})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-4 mt-1 text-sm text-gray-500",children:[d&&(0,ut.jsx)("span",{className:"truncate",children:d}),h&&(0,ut.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,ut.jsx)(nt,{className:"h-3 w-3"}),(0,ut.jsxs)("span",{children:[h,"h"]})]}),p&&(0,ut.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,ut.jsx)(lt,{className:"h-3 w-3"}),(0,ut.jsx)("span",{className:"truncate",children:p})]}),l&&c>0&&(0,ut.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,ut.jsx)(Be,{className:"h-3 w-3"}),(0,ut.jsx)("span",{children:w(c,u)})]}),(0,ut.jsx)("span",{children:v(e.modified)})]})]})]})})},ht=({stats:e=[],className:t="",cols:s=7})=>e.length?(0,ut.jsx)("div",{className:`grid grid-cols-1 sm:grid-cols-2 ${{1:"lg:grid-cols-1",2:"lg:grid-cols-2",3:"lg:grid-cols-3",4:"lg:grid-cols-4",5:"lg:grid-cols-5",6:"lg:grid-cols-6",7:"lg:grid-cols-7",8:"lg:grid-cols-8"}[s]||"lg:grid-cols-7"} gap-4 ${t}`,children:e.map((e,t)=>{const s=e.icon;return(0,ut.jsx)("div",{className:`${e.bgColor||"bg-white"} overflow-hidden shadow rounded-lg border border-gray-200`,children:(0,ut.jsx)("div",{className:"p-5",children:(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsx)("div",{className:"flex-shrink-0",children:(0,ut.jsx)(s,{className:`h-8 w-8 ${e.iconColor||"text-gray-400"}`})}),(0,ut.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,ut.jsxs)("dl",{children:[(0,ut.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:e.label}),(0,ut.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:e.value})]})})]})})},t)})}):null,pt=({currentMode:e,onModeChange:t,modes:s=[],className:r="",size:a="sm"})=>{if(!s.length)return null;const n={xs:"p-1 text-xs",sm:"p-2 text-sm",md:"p-3 text-base",lg:"p-4 text-lg"},l={xs:"h-3 w-3",sm:"h-4 w-4",md:"h-5 w-5",lg:"h-6 w-6"};return(0,ut.jsx)("div",{className:`flex items-center border border-gray-200 rounded-lg p-1 ${r}`,children:s.map(s=>{const r=s.icon,o=e===s.value;return(0,ut.jsxs)("button",{onClick:()=>t(s.value),className:`${n[a]} rounded flex items-center space-x-1 transition-colors ${o?"bg-indigo-100 text-indigo-700":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,title:`Switch to ${s.label} view`,children:[r&&(0,ut.jsx)(r,{className:l[a]}),(0,ut.jsx)("span",{children:s.label})]},s.value)})})},xt=Qe("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),gt=({size:e="default",message:t,variant:s="default",centered:r=!0,className:a="",fullScreen:n=!1,overlay:l=!1})=>{const o={xs:{spinner:"h-3 w-3",text:"text-xs"},sm:{spinner:"h-4 w-4",text:"text-sm"},default:{spinner:"h-6 w-6",text:"text-base"},lg:{spinner:"h-8 w-8",text:"text-lg"},xl:{spinner:"h-12 w-12",text:"text-xl"}}[e],i={default:{spinner:"text-gray-400",text:"text-gray-600"},primary:{spinner:"text-indigo-600",text:"text-indigo-600"},white:{spinner:"text-white",text:"text-white"}}[s],c=[r&&"flex flex-col items-center justify-center",n&&"fixed inset-0 z-50",n&&l&&"bg-black bg-opacity-50",!n&&r&&"py-8",a].filter(Boolean).join(" "),u=["flex flex-col items-center justify-center",t?"space-y-3":"",n&&"bg-white rounded-lg p-8 shadow-lg"].filter(Boolean).join(" ");return(0,ut.jsx)("div",{className:c,children:(0,ut.jsxs)("div",{className:u,children:[(0,ut.jsx)(xt,{className:`${o.spinner} ${i.spinner} animate-spin`}),t&&(0,ut.jsx)("p",{className:`${o.text} ${i.text} font-medium`,children:t})]})})},ft=({children:e,variant:t="primary",type:s="button",className:r="",...a})=>{const n=`px-4 py-2 rounded-md font-semibold text-sm shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed ${{primary:"bg-indigo-600 text-white hover:bg-indigo-700 focus:ring-indigo-500",secondary:"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50 focus:ring-indigo-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500"}[t]} ${r}`;return(0,ut.jsx)("button",{type:s,className:n,...a,children:e})},yt=({icon:e,title:t,description:s,actionText:r,onAction:a,actionVariant:n="primary",size:l="default",className:o="",children:i})=>{const c={small:{container:"py-6",icon:"h-8 w-8",title:"text-lg",description:"text-sm",spacing:"space-y-3"},default:{container:"py-12",icon:"h-12 w-12",title:"text-xl",description:"text-base",spacing:"space-y-4"},large:{container:"py-20",icon:"h-16 w-16",title:"text-2xl",description:"text-lg",spacing:"space-y-6"}}[l];return(0,ut.jsx)("div",{className:`text-center ${c.container} ${o}`,children:(0,ut.jsxs)("div",{className:`mx-auto ${c.spacing}`,children:[e&&(0,ut.jsx)("div",{className:"mx-auto flex items-center justify-center",children:(0,ut.jsx)(e,{className:`${c.icon} text-gray-400`,strokeWidth:1.5})}),(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h3",{className:`${c.title} font-semibold text-gray-900`,children:t}),s&&(0,ut.jsx)("p",{className:`mt-2 ${c.description} text-gray-500 max-w-sm mx-auto`,children:s})]}),i,r&&a&&(0,ut.jsx)("div",{children:(0,ut.jsx)(ft,{variant:n,onClick:a,className:"inline-flex items-center",children:r})})]})})},bt=({title:e="Items",description:t,createButtonText:s="Create Item",onCreateClick:r,statistics:a=[],items:n=[],loading:l=!1,viewMode:o="cards",onViewModeChange:i,viewModes:c=[{value:"cards",label:"Cards"},{value:"list",label:"List"}],children:u,emptyStateComponent:d,filtersComponent:m,emptyState:h,className:p="",showStatistics:x=!0,showViewToggle:g=!0,showCreateButton:f=!0,showItemCount:y=!0})=>{const b=e||"Items",v=b.toLowerCase(),w={title:`No ${v} found`,description:`You haven't created any ${v} yet.`,actionText:s||`Create ${b}`,...h};return(0,ut.jsxs)("div",{className:`space-y-6 ${p}`,children:[(0,ut.jsxs)("div",{className:"flex justify-between items-center",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:b}),t&&(0,ut.jsx)("p",{className:"text-gray-600 mt-1",children:t})]}),f&&(0,ut.jsx)("div",{className:"flex items-center space-x-3",children:(0,ut.jsxs)("button",{onClick:r,disabled:l,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,ut.jsx)(Ye,{className:"h-4 w-4 mr-2"}),s||`Create ${b}`]})})]}),m&&(0,ut.jsx)("div",{className:"bg-white shadow rounded-lg border border-gray-200",children:m}),x&&a.length>0&&(0,ut.jsx)(ht,{stats:a}),(0,ut.jsxs)("div",{className:"flex justify-between items-center",children:[y&&(0,ut.jsx)("div",{className:"text-sm text-gray-600",children:l?"Loading...":`${n.length} ${v}${1!==n.length?"s":""} found`}),g&&i&&(0,ut.jsx)(pt,{currentMode:o,onModeChange:i,modes:c})]}),l&&0===n.length?(0,ut.jsx)("div",{className:"text-center py-12",children:(0,ut.jsx)(gt,{size:"lg",message:`Loading ${v}...`})}):0===n.length?d||(0,ut.jsx)(yt,{icon:w.icon,title:w.title,description:w.description,actionText:w.actionText,onAction:r}):(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsx)("div",{className:"cards"===o?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6":"space-y-4",children:u}),l&&n.length>0&&(0,ut.jsx)("div",{className:"text-center py-4",children:(0,ut.jsx)(gt,{size:"sm",message:`Loading more ${v}...`})})]})]})},vt=Qe("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),wt=Qe("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),jt=({isOpen:e,onClose:t,onConfirm:s,title:n="Confirm Delete",message:l,confirmText:o="Delete",cancelText:i="Cancel",requiresTyping:c=!1,itemName:u="",loading:d=!1,variant:m="danger"})=>{const[h,p]=(0,r.useState)(""),[x,g]=(0,r.useState)(!1);a().useEffect(()=>{e&&(p(""),g(!1))},[e]),a().useEffect(()=>{const s=s=>{"Escape"===s.key&&e&&!x&&t()};if(e)return document.addEventListener("keydown",s),()=>document.removeEventListener("keydown",s)},[e,x,t]);const f={danger:{icon:"text-red-600",iconBg:"bg-red-100",confirmButton:"danger"},warning:{icon:"text-yellow-600",iconBg:"bg-yellow-100",confirmButton:"primary"}}[m];return e?(0,ut.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,ut.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:x?void 0:t}),(0,ut.jsx)("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,ut.jsxs)("div",{className:"relative transform overflow-hidden rounded-lg bg-white px-4 pb-4 pt-5 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg sm:p-6",children:[(0,ut.jsx)("button",{onClick:t,disabled:x,className:"absolute right-4 top-4 text-gray-400 hover:text-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:(0,ut.jsx)(vt,{className:"h-5 w-5"})}),(0,ut.jsxs)("div",{className:"sm:flex sm:items-start",children:[(0,ut.jsx)("div",{className:`mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full ${f.iconBg} sm:mx-0 sm:h-10 sm:w-10`,children:(0,ut.jsx)(wt,{className:`h-6 w-6 ${f.icon}`})}),(0,ut.jsxs)("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left w-full",children:[(0,ut.jsx)("h3",{className:"text-base font-semibold leading-6 text-gray-900",children:n}),l&&(0,ut.jsx)("div",{className:"mt-2",children:(0,ut.jsx)("p",{className:"text-sm text-gray-500",children:l})}),c&&(0,ut.jsxs)("div",{className:"mt-4",children:[(0,ut.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:["Type ",(0,ut.jsx)("span",{className:"font-mono font-bold",children:"DELETE"})," to confirm:"]}),(0,ut.jsx)("input",{type:"text",value:h,onChange:e=>p(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500",placeholder:"Type DELETE here",disabled:x})]}),u&&(0,ut.jsxs)("div",{className:"mt-3 p-3 bg-gray-50 rounded-md",children:[(0,ut.jsx)("p",{className:"text-sm text-gray-600",children:"Item to delete:"}),(0,ut.jsx)("p",{className:"font-medium text-gray-900 truncate",children:u})]})]})]}),(0,ut.jsxs)("div",{className:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse sm:gap-3",children:[(0,ut.jsx)(ft,{variant:f.confirmButton,onClick:async()=>{if(!c||"DELETE"===h){g(!0);try{await s(),t()}catch(e){console.error("Error during deletion:",e)}finally{g(!1)}}},disabled:x||c&&"DELETE"!==h,className:"w-full sm:w-auto",children:x?(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing..."]}):o}),(0,ut.jsx)(ft,{variant:"secondary",onClick:t,disabled:x,className:"mt-3 w-full sm:mt-0 sm:w-auto",children:i})]})]})})]}):null},Nt=()=>{const[e,t]=(0,r.useState)("all"),[s,a]=(0,r.useState)("all"),[n,l]=(0,r.useState)("all"),[o,i]=(0,r.useState)("all"),[c,u]=(0,r.useState)(""),[d,m]=(0,r.useState)(!1),[h,p]=(0,r.useState)(!1),[x,g]=(0,r.useState)(null),[f,y]=(0,r.useState)("cards"),{courses:b,loading:v,error:w,pagination:j,computed:N,createCourse:C,deleteCourse:k,duplicateCourse:_,creating:S}=Ze({search:c,type:"all"!==e?e:null,category:"all"!==s?s:null,status:"all"!==o?o:null,autoFetch:!0}),E=(0,r.useMemo)(()=>["all","beginner","intermediate","advanced","expert"],[]),$=(0,r.useMemo)(()=>["all","online","hybrid","workshop","masterclass"],[]),M=(0,r.useMemo)(()=>["all","programming","design","business","marketing","data-science"],[]),q=(0,r.useMemo)(()=>["all","publish","draft","private","pending"],[]),z=(0,r.useMemo)(()=>{const e=N.totalCourses||0,t=N.averagePrice||0,s=N.totalRevenue||0,r=N.freeCourses||0,a=N.paidCourses||0,n=N.featuredCourses||0;return[{label:"Total Courses",value:e,icon:We,iconColor:"text-blue-500"},{label:"Average Price",value:t>0?`$${t}`:"Free",icon:Be,iconColor:"text-green-500"},{label:"Total Revenue",value:`$${s.toLocaleString()}`,icon:Ve,iconColor:"text-purple-500"},{label:"Free Courses",value:r,icon:He,iconColor:"text-blue-400"},{label:"Paid Courses",value:a,icon:Je,iconColor:"text-yellow-500"},{label:"Featured",value:n,icon:Xe,iconColor:"text-orange-500"}]},[N]),P=(0,r.useCallback)(e=>{t(e)},[]),R=(0,r.useCallback)(e=>{a(e)},[]),T=(0,r.useCallback)(e=>{l(e)},[]),L=(0,r.useCallback)(e=>{i(e)},[]),D=(0,r.useCallback)(e=>{u(e.target.value)},[]),A=((0,r.useCallback)(async e=>{try{const t=await C(e);return m(!1),t}catch(e){throw console.error("Error creating course:",e),e}},[C]),(0,r.useCallback)(e=>{g(e),p(!0)},[])),F=(0,r.useCallback)(async()=>{if(x)try{await k(x.id),p(!1),g(null)}catch(e){console.error("Error deleting course:",e)}},[x,k]),I=(0,r.useCallback)(async e=>{try{await _(e.id)}catch(e){console.error("Error duplicating course:",e)}},[_]),U=(0,r.useCallback)(e=>{console.log("Navigate to course details:",e.id)},[]),O=(0,r.useCallback)(()=>{u("")},[]),Q=(0,r.useCallback)(()=>{t("all"),a("all"),l("all"),i("all"),u("")},[]);return(0,ut.jsxs)("div",{className:"space-y-6",children:[(0,ut.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Course Management"}),(0,ut.jsx)("p",{className:"text-gray-600 mt-1",children:"Create and manage your courses"})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-3",children:[v&&(0,ut.jsxs)("div",{className:"flex items-center text-sm text-gray-500",children:[(0,ut.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500 mr-2"}),"Loading..."]}),(0,ut.jsxs)("button",{onClick:()=>m(!0),disabled:S,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[(0,ut.jsx)(Ye,{className:"h-4 w-4 mr-2"}),S?"Creating...":"Create Course"]})]})]}),(0,ut.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:z.map((e,t)=>{const s=e.icon;return(0,ut.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsx)("div",{className:`flex-shrink-0 ${e.iconColor}`,children:(0,ut.jsx)(s,{className:"h-6 w-6"})}),(0,ut.jsxs)("div",{className:"ml-3",children:[(0,ut.jsx)("p",{className:"text-sm font-medium text-gray-600",children:e.label}),(0,ut.jsx)("p",{className:"text-lg font-semibold text-gray-900",children:e.value})]})]})},t)})})]}),(0,ut.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[(0,ut.jsxs)("div",{className:"relative",children:[(0,ut.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,ut.jsx)(Ke,{className:"h-5 w-5 text-gray-400"})}),(0,ut.jsx)("input",{type:"text",placeholder:"Search courses...",value:c,onChange:D,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500"}),c&&(0,ut.jsxs)("button",{onClick:O,className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:[(0,ut.jsx)("span",{className:"sr-only",children:"Clear search"}),"×"]})]}),(0,ut.jsx)("select",{value:e,onChange:e=>P(e.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:$.map(e=>(0,ut.jsx)("option",{value:e,children:"all"===e?"All Types":e.charAt(0).toUpperCase()+e.slice(1)},e))}),(0,ut.jsx)("select",{value:s,onChange:e=>R(e.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:M.map(e=>(0,ut.jsx)("option",{value:e,children:"all"===e?"All Categories":e.charAt(0).toUpperCase()+e.slice(1).replace("-"," ")},e))}),(0,ut.jsx)("select",{value:n,onChange:e=>T(e.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:E.map(e=>(0,ut.jsx)("option",{value:e,children:"all"===e?"All Difficulties":e.charAt(0).toUpperCase()+e.slice(1)},e))}),(0,ut.jsx)("select",{value:o,onChange:e=>L(e.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:q.map(e=>(0,ut.jsx)("option",{value:e,children:"all"===e?"All Statuses":e.charAt(0).toUpperCase()+e.slice(1)},e))})]}),(0,ut.jsx)("div",{className:"mt-4 flex justify-end",children:(0,ut.jsx)("button",{onClick:Q,className:"px-3 py-1 text-sm text-gray-600 hover:text-gray-900",children:"Clear All Filters"})})]}),(0,ut.jsx)(bt,{items:b,loading:v,error:w,pagination:j,viewMode:f,onViewModeChange:y,renderCard:e=>(0,ut.jsx)(mt,{course:e,onEdit:U,onDelete:A,onDuplicate:I,onClick:U},e.id),emptyState:{icon:We,title:"No courses found",description:"Get started by creating your first course.",actionLabel:"Create Course",onAction:()=>m(!0)}}),d&&(0,ut.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,ut.jsxs)("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,ut.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,ut.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,ut.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,ut.jsxs)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[(0,ut.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Create New Course"}),(0,ut.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"Course creation form would go here..."})]}),(0,ut.jsx)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:(0,ut.jsx)("button",{onClick:()=>m(!1),className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Close"})})]})]})}),h&&x&&(0,ut.jsx)(jt,{isOpen:h,onClose:()=>p(!1),onConfirm:F,title:"Delete Course",message:`Are you sure you want to delete "${x.title?.rendered||x.title}"? This action cannot be undone.`,confirmLabel:"Delete Course",isLoading:!1})]})},Ct=Qe("circle-play",[["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),kt=Qe("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),_t=Qe("video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]),St=Qe("lock-open",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]),Et=Qe("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),$t=(e,t,s=[])=>{const a=(0,r.useRef)(null),n=(0,r.useRef)(e);return(0,r.useEffect)(()=>{n.current=e},[e]),(0,r.useEffect)(()=>()=>{a.current&&clearTimeout(a.current)},[]),(0,r.useCallback)((...e)=>{a.current&&clearTimeout(a.current),a.current=setTimeout(()=>{n.current(...e)},t)},[t,...s])},Mt=Qe("circle-question-mark",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),qt=Qe("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),zt=Qe("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Pt=Qe("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),Rt=Qe("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]),Tt=({lesson:e,viewMode:t="cards",onEdit:s,onDelete:a,onDuplicate:n,courses:l=[],showCourse:o=!0,className:i=""})=>{const c=e.meta?._lesson_type||"text",u=e.meta?._content_type||"free",d=parseInt(e.meta?._duration_minutes||"0"),m=e.meta?._course_id,h="yes"===e.meta?._has_quiz||"quiz"===e.meta?._lesson_type,p=e.meta?._video_url,x=(0,r.useMemo)(()=>m&&l.length?l.find(e=>e.id.toString()===m.toString()||e.id===parseInt(m,10)):null,[m,l]),g=e=>{switch(e){case"publish":return"text-green-600 bg-green-100";case"draft":return"text-yellow-600 bg-yellow-100";default:return"text-gray-600 bg-gray-100"}},f=[{label:"Edit",icon:et,onClick:s,color:"text-blue-600"},{label:"Duplicate",icon:tt,onClick:n,color:"text-green-600"},{label:"Delete",icon:st,onClick:a,color:"text-red-600",divider:!0}].filter(e=>e.onClick),y=(e=>{switch(e){case"video":return _t;case"quiz":return Mt;default:return qt}})(c),b="premium"===u?Et:St;return(0,ut.jsx)(dt,{item:e,viewMode:t,actions:f,className:i,clickable:!1,children:"cards"===t?(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[(0,ut.jsx)(y,{className:"h-4 w-4"}),(0,ut.jsx)("span",{className:"capitalize",children:c})]}),h&&(0,ut.jsxs)("div",{className:"flex items-center space-x-1 text-sm text-purple-600",children:[(0,ut.jsx)(Mt,{className:"h-3 w-3"}),(0,ut.jsx)("span",{children:"Quiz"})]})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsx)(b,{className:"h-4 w-4 text-gray-400"}),(0,ut.jsx)("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${g(e.status)}`,children:"publish"===e.status?(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsx)(zt,{className:"h-3 w-3 mr-1"}),"Published"]}):(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsx)(Pt,{className:"h-3 w-3 mr-1"}),e.status]})})]})]}),(0,ut.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2 line-clamp-2",children:e.title?.rendered||e.title||"Untitled Lesson"}),e.excerpt?.rendered&&(0,ut.jsx)("p",{className:"text-sm text-gray-600 mb-4 line-clamp-3",children:e.excerpt.rendered.replace(/<[^>]*>/g,"")}),(0,ut.jsxs)("div",{className:"space-y-2",children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[d>0&&(0,ut.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,ut.jsx)(nt,{className:"h-4 w-4"}),(0,ut.jsxs)("span",{children:[d," min"]})]}),p&&(0,ut.jsxs)("div",{className:"flex items-center space-x-1 text-blue-600",children:[(0,ut.jsx)(Rt,{className:"h-4 w-4"}),(0,ut.jsx)("span",{children:"Video"})]})]}),o&&x&&(0,ut.jsxs)("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[(0,ut.jsx)(We,{className:"h-4 w-4"}),(0,ut.jsx)("span",{className:"truncate",children:x.title})]}),(0,ut.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-400",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,ut.jsx)(it,{className:"h-3 w-3"}),(0,ut.jsx)("span",{children:new Date(e.modified).toLocaleDateString()})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,ut.jsx)(lt,{className:"h-3 w-3"}),(0,ut.jsxs)("span",{children:["ID: ",e.id]})]})]})]})]}):(0,ut.jsxs)("div",{className:"flex items-center w-full",children:[(0,ut.jsx)("div",{className:"flex-shrink-0 mr-4",children:(0,ut.jsx)("div",{className:"h-10 w-10 bg-gray-100 rounded-lg flex items-center justify-center",children:(0,ut.jsx)(y,{className:"h-5 w-5 text-gray-600"})})}),(0,ut.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ut.jsx)("h3",{className:"text-sm font-medium text-gray-900 truncate",children:e.title?.rendered||e.title||"Untitled Lesson"}),(0,ut.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[h&&(0,ut.jsx)(Mt,{className:"h-4 w-4 text-purple-500"}),(0,ut.jsx)(b,{className:"h-4 w-4 text-gray-400"}),(0,ut.jsx)("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${g(e.status)}`,children:e.status})]})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-4 mt-1 text-sm text-gray-500",children:[o&&x&&(0,ut.jsx)("span",{className:"truncate",children:x.title}),d>0&&(0,ut.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,ut.jsx)(nt,{className:"h-3 w-3"}),(0,ut.jsxs)("span",{children:[d,"m"]})]}),(0,ut.jsx)("span",{children:new Date(e.modified).toLocaleDateString()})]})]})]})})},Lt=()=>{const[e,t]=(0,r.useState)("all"),[s,a]=(0,r.useState)("all"),[n,l]=(0,r.useState)("all"),[o,i]=(0,r.useState)(!1),[c,u]=(0,r.useState)(!1),[d,m]=(0,r.useState)(null),[h,p]=(0,r.useState)("cards"),{searchValue:x,isSearching:g,handleSearchChange:f,clearSearch:y}=((e="",t,s=500)=>{const[a,n]=(0,r.useState)(e),[l,o]=(0,r.useState)(!1),i=$t(async e=>{o(!0);try{await t(e)}finally{o(!1)}},s,[t]);return{searchValue:a,isSearching:l,handleSearchChange:(0,r.useCallback)(e=>{n(e),i(e)},[i]),clearSearch:(0,r.useCallback)(()=>{n(""),i("")},[i]),setSearchValue:n}})("",async e=>{console.log("🔍 Lesson search triggered:",e)},500),{filters:b,isFiltering:v,updateFilter:w,resetFilters:j}=((e={},t,s=300)=>{const[a,n]=(0,r.useState)(e),[l,o]=(0,r.useState)(!1),i=$t(async e=>{o(!0);try{await t(e)}finally{o(!1)}},s,[t]);return{filters:a,isFiltering:l,updateFilter:(0,r.useCallback)((e,t)=>{n(s=>{const r={...s,[e]:t};return i(r),r})},[i]),updateFilters:(0,r.useCallback)(e=>{n(t=>{const s={...t,...e};return i(s),s})},[i]),resetFilters:(0,r.useCallback)(()=>{n(e),i(e)},[e,i])}})({courseId:"all",type:"all",contentType:"all"},async e=>{console.log("🔧 Lesson filters changed:",e)},300),{lessons:N,loading:C,error:k,pagination:_,computed:S,createLesson:E,deleteLesson:$,duplicateLesson:M,creating:q,refreshLessons:z}=((e={})=>{const{courseId:t=null,type:s=null,contentType:a=null,search:n="",autoFetch:l=!0,initialFilters:o={},debounceMs:i=500}=e,[c,u]=(0,r.useState)([]),[d,m]=(0,r.useState)(!0),[h,p]=(0,r.useState)(!1),[x,g]=(0,r.useState)(null),[f,y]=(0,r.useState)({currentPage:1,totalPages:1,total:0,perPage:20}),[b,v]=(0,r.useState)(!1),[w,j]=(0,r.useState)({search:n||"",courseId:t,type:s,contentType:a,status:"publish,draft,private",...o}),N=(0,r.useRef)(w),C=(0,r.useRef)(e),k=(0,r.useRef)(null),_=(0,r.useRef)(!0),S=(0,r.useRef)("");(0,r.useEffect)(()=>{N.current=w},[w]),(0,r.useEffect)(()=>{C.current=e},[e]),(0,r.useEffect)(()=>()=>{_.current=!1,k.current&&clearTimeout(k.current)},[]);const E=async(e,t={})=>{try{const s={headers:{"Content-Type":"application/json","X-WP-Nonce":Ge().nonce},credentials:"same-origin",...t},r=await fetch(e,s);if(!r.ok){const e=await r.text();throw new Error(`API Error ${r.status}: ${r.statusText} - ${e}`)}return r}catch(e){throw console.error("API Request Error:",e),e}},$=(0,r.useCallback)(async(e={})=>{const{reset:t=!1,page:s=1,additionalFilters:r={}}=e;try{t&&(m(!0),g(null));const e=Ge(),a=N.current,n=new URLSearchParams({page:s.toString(),per_page:"20",status:a.status||"publish,draft",orderby:"menu_order",order:"asc",_embed:"true"});if(a.search&&n.append("search",a.search),a.courseId&&(n.append("meta_query[0][key]","_course_id"),n.append("meta_query[0][value]",a.courseId.toString()),n.append("meta_query[0][compare]","="),n.append("meta_query[0][type]","NUMERIC")),a.type){const e=a.courseId?1:0;n.append(`meta_query[${e}][key]`,"_lesson_type"),n.append(`meta_query[${e}][value]`,a.type),n.append(`meta_query[${e}][compare]`,"=")}if(a.contentType){const e=(a.courseId?1:0)+(a.type?1:0);n.append(`meta_query[${e}][key]`,"_content_type"),n.append(`meta_query[${e}][value]`,a.contentType),n.append(`meta_query[${e}][compare]`,"=")}[a.courseId,a.type,a.contentType].filter(Boolean).length>1&&n.append("meta_query[relation]","AND"),Object.entries(r).forEach(([e,t])=>{null!=t&&""!==t&&n.append(e,t)});const l=`${e.endpoints.lessons}?${n}`,o=`${l}-${s}-${t}`;if(o===S.current)return void console.log("🚫 Duplicate lesson request prevented:",l);S.current=o,console.log("🚀 Fetching lessons:",l);const i=await E(l),c=await i.json();if(!_.current)return;const d=i.headers.get("X-WP-Total"),h=i.headers.get("X-WP-TotalPages"),p={currentPage:s,totalPages:h?parseInt(h,10):1,total:d?parseInt(d,10):c.length,perPage:20};y(p),v(s<p.totalPages),u(t||1===s?c:e=>{const t=new Set(e.map(e=>e.id)),s=c.filter(e=>!t.has(e.id));return[...e,...s]}),console.log("✅ Lessons loaded:",c.length)}catch(e){console.error("❌ Error fetching lessons:",e),_.current&&(g(e.message||"Failed to fetch lessons"),(t||1===s)&&(u([]),y({currentPage:1,totalPages:1,total:0,perPage:20}),v(!1)))}finally{_.current&&m(!1)}},[]),M=(0,r.useCallback)((e={})=>{k.current&&clearTimeout(k.current),k.current=setTimeout(()=>{_.current&&$({reset:!0,...e})},i)},[$,i]);(0,r.useEffect)(()=>{l&&(console.log("🎯 Initial lesson load"),$({reset:!0}))},[]),(0,r.useEffect)(()=>{j(e=>{const r={...e,search:n||"",courseId:t,type:s,contentType:a};return JSON.stringify(r)!==JSON.stringify(e)?r:e})},[n,t,s,a]),(0,r.useEffect)(()=>{l&&(console.log("🔄 Lesson filters changed, debouncing fetch..."),M())},[w,M,l]);const q=(0,r.useCallback)(async e=>{try{p(!0),g(null);const t=Ge(),s={title:e.title||"",content:e.content||"",excerpt:e.excerpt||"",status:e.status||"draft",menu_order:e.menuOrder||1,meta:{_course_id:e.courseId||"",_lesson_order:e.lessonOrder||"1",_duration_minutes:e.durationMinutes||"",_lesson_type:e.type||"video",_video_url:e.videoUrl||"",_content_type:e.contentType||"free",_prerequisite_lessons:e.prerequisiteLessons||"",_resources_urls:e.resourcesUrls||"",_completion_criteria:e.completionCriteria||"view",...e.meta}};console.log("🚀 Creating lesson:",s);const r=await E(t.endpoints.lessons,{method:"POST",body:JSON.stringify(s)}),a=await r.json();return u(e=>[a,...e]),y(e=>({...e,total:e.total+1})),console.log("✅ Lesson created:",a),a}catch(e){throw console.error("❌ Error creating lesson:",e),g(e.message||"Failed to create lesson"),e}finally{p(!1)}},[]),z=(0,r.useCallback)(async e=>{try{g(null);const t=Ge();console.log("🗑️ Deleting lesson:",e),await E(`${t.endpoints.lessons}/${e}`,{method:"DELETE"}),u(t=>t.filter(t=>t.id!==e)),y(e=>({...e,total:Math.max(0,e.total-1)})),console.log("✅ Lesson deleted")}catch(e){throw console.error("❌ Error deleting lesson:",e),g(e.message||"Failed to delete lesson"),e}},[]),P=(0,r.useCallback)(async e=>{try{g(null);const t=c.find(t=>t.id===e);if(!t)throw new Error("Lesson not found");const s={title:`${t.title?.rendered||t.title} (Copy)`,content:t.content?.rendered||t.content||"",excerpt:t.excerpt?.rendered||t.excerpt||"",status:"draft",courseId:t.meta?._course_id,type:t.meta?._lesson_type,contentType:t.meta?._content_type,durationMinutes:t.meta?._duration_minutes,videoUrl:t.meta?._video_url,prerequisiteLessons:t.meta?._prerequisite_lessons,resourcesUrls:t.meta?._resources_urls,completionCriteria:t.meta?._completion_criteria,meta:t.meta};return console.log("📋 Duplicating lesson:",e),await q(s)}catch(e){throw console.error("❌ Error duplicating lesson:",e),g(e.message||"Failed to duplicate lesson"),e}},[c,q]),R=(0,r.useCallback)(()=>{b&&!d&&$({page:f.currentPage+1,reset:!1})},[b,d,f.currentPage,$]),T=(0,r.useCallback)(()=>{S.current="",$({reset:!0})},[$]),L=(0,r.useMemo)(()=>({totalLessons:c.length,publishedLessons:c.filter(e=>"publish"===e.status).length,draftLessons:c.filter(e=>"draft"===e.status).length,privateLessons:c.filter(e=>"private"===e.status).length,lessonsByType:c.reduce((e,t)=>{const s=t.meta?._lesson_type||"video";return e[s]=(e[s]||0)+1,e},{}),lessonsByContentType:c.reduce((e,t)=>{const s=t.meta?._content_type||"free";return e[s]=(e[s]||0)+1,e},{}),averageDuration:c.length>0?Math.round(c.reduce((e,t)=>e+parseInt(t.meta?._duration_minutes||"0"),0)/c.length):0,totalDuration:c.reduce((e,t)=>e+parseInt(t.meta?._duration_minutes||"0"),0),lessonsWithVideo:c.filter(e=>e.meta?._video_url&&""!==e.meta._video_url.trim()).length,lessonsWithPrerequisites:c.filter(e=>e.meta?._prerequisite_lessons&&""!==e.meta._prerequisite_lessons.trim()).length,freeLessons:c.filter(e=>"free"===e.meta?._content_type).length,premiumLessons:c.filter(e=>"premium"===e.meta?._content_type).length}),[c]);return{lessons:c,loading:d,creating:h,error:x,pagination:f,hasMore:b,filters:w,computed:L,createLesson:q,deleteLesson:z,duplicateLesson:P,refreshLessons:T,loadMoreLessons:R,fetchLessons:M}})({search:x,courseId:"all"!==b.courseId?b.courseId:null,type:"all"!==b.type?b.type:null,contentType:"all"!==b.contentType?b.contentType:null,autoFetch:!0,debounceMs:500}),{courses:P}=Ze({autoFetch:!0,debounceMs:300}),R=(0,r.useCallback)(e=>{t(e),w("courseId",e)},[w]),T=(0,r.useCallback)(e=>{a(e),w("type",e)},[w]),L=(0,r.useCallback)(e=>{l(e),w("contentType",e)},[w]),D=(0,r.useCallback)(e=>{const t=e.target.value;f(t)},[f]),A=((0,r.useCallback)(async e=>{try{const t=await E(e);return i(!1),t}catch(e){throw console.error("Error creating lesson:",e),e}},[E]),(0,r.useCallback)(e=>{m(e),u(!0)},[])),F=(0,r.useCallback)(async()=>{if(d)try{await $(d.id),u(!1),m(null)}catch(e){console.error("Error deleting lesson:",e)}},[d,$]),I=(0,r.useCallback)(async e=>{try{await M(e.id)}catch(e){console.error("Error duplicating lesson:",e)}},[M]),U=(0,r.useCallback)(e=>{console.log("Navigate to lesson details:",e.id)},[]),O=(0,r.useCallback)(()=>{z()},[z]),Q=(0,r.useMemo)(()=>{const e=S.totalLessons||0,t=S.averageDuration||0,s=S.totalDuration||0,r=S.lessonsWithVideo||0,a=S.freeLessons||0,n=S.premiumLessons||0;return[{label:"Total Lessons",value:e,icon:Ct,iconColor:"text-blue-500"},{label:"Avg. Duration",value:t>0?`${t}min`:"N/A",icon:nt,iconColor:"text-green-500"},{label:"Total Duration",value:s>0?`${Math.floor(s/60)}h ${s%60}m`:"N/A",icon:kt,iconColor:"text-purple-500"},{label:"Video Lessons",value:r,icon:_t,iconColor:"text-red-500"},{label:"Free Lessons",value:a,icon:St,iconColor:"text-blue-400"},{label:"Premium Lessons",value:n,icon:Et,iconColor:"text-yellow-500"}]},[S]),W=(0,r.useMemo)(()=>[{value:"all",label:"All Courses"},...P.map(e=>({value:e.id.toString(),label:e.title?.rendered||e.title||`Course ${e.id}`}))],[P]);return(0,ut.jsxs)("div",{className:"space-y-6",children:[(0,ut.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Lesson Management"}),(0,ut.jsx)("p",{className:"text-gray-600 mt-1",children:"Create and manage your lessons"})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-3",children:[(C||g||v)&&(0,ut.jsxs)("div",{className:"flex items-center text-sm text-gray-500",children:[(0,ut.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500 mr-2"}),g?"Searching...":v?"Filtering...":"Loading..."]}),(0,ut.jsx)("button",{onClick:O,disabled:C,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:"Refresh"}),(0,ut.jsx)("button",{onClick:()=>i(!0),disabled:q,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:q?"Creating...":"Create Lesson"})]})]}),(0,ut.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:Q.map((e,t)=>{const s=e.icon;return(0,ut.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsx)("div",{className:`flex-shrink-0 ${e.iconColor}`,children:(0,ut.jsx)(s,{className:"h-6 w-6"})}),(0,ut.jsxs)("div",{className:"ml-3",children:[(0,ut.jsx)("p",{className:"text-sm font-medium text-gray-600",children:e.label}),(0,ut.jsx)("p",{className:"text-lg font-semibold text-gray-900",children:e.value})]})]})},t)})})]}),(0,ut.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,ut.jsxs)("div",{className:"relative",children:[(0,ut.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,ut.jsx)(Ke,{className:"h-5 w-5 text-gray-400"})}),(0,ut.jsx)("input",{type:"text",placeholder:"Search lessons...",value:x,onChange:D,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500"}),x&&(0,ut.jsxs)("button",{onClick:y,className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:[(0,ut.jsx)("span",{className:"sr-only",children:"Clear search"}),"×"]})]}),(0,ut.jsx)("select",{value:e,onChange:e=>R(e.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:W.map(e=>(0,ut.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,ut.jsx)("select",{value:s,onChange:e=>T(e.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[{value:"all",label:"All Types"},{value:"video",label:"Video"},{value:"text",label:"Text"},{value:"quiz",label:"Quiz"},{value:"assignment",label:"Assignment"},{value:"live",label:"Live Session"}].map(e=>(0,ut.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,ut.jsx)("select",{value:n,onChange:e=>L(e.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[{value:"all",label:"All Access Types"},{value:"free",label:"Free"},{value:"premium",label:"Premium"}].map(e=>(0,ut.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,ut.jsx)("div",{className:"mt-4 flex justify-end",children:(0,ut.jsx)("button",{onClick:j,className:"px-3 py-1 text-sm text-gray-600 hover:text-gray-900",children:"Clear All Filters"})})]}),(0,ut.jsx)(bt,{items:N,loading:C,error:k,pagination:_,viewMode:h,onViewModeChange:p,renderCard:e=>(0,ut.jsx)(Tt,{lesson:e,onEdit:U,onDelete:A,onDuplicate:I,onClick:U},e.id),emptyState:{icon:Ct,title:"No lessons found",description:"Get started by creating your first lesson.",actionLabel:"Create Lesson",onAction:()=>i(!0)}}),o&&(0,ut.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,ut.jsxs)("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,ut.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,ut.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,ut.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,ut.jsxs)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[(0,ut.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Create New Lesson"}),(0,ut.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"Lesson creation form would go here..."})]}),(0,ut.jsx)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:(0,ut.jsx)("button",{onClick:()=>i(!1),className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Close"})})]})]})}),c&&d&&(0,ut.jsx)(jt,{isOpen:c,onClose:()=>u(!1),onConfirm:F,title:"Delete Lesson",message:`Are you sure you want to delete "${d.title?.rendered||d.title}"? This action cannot be undone.`,confirmLabel:"Delete Lesson",isLoading:!1})]})},Dt=()=>(0,ut.jsx)("div",{className:"wrap",children:(0,ut.jsx)(Lt,{showCourseSelection:!0,title:"Lesson Management"})}),At=Qe("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),Ft=Qe("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),It=Qe("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),Ut=(e={})=>{const{courseId:t=null,difficulty:s=null,category:a=null,search:n="",autoFetch:l=!0,initialFilters:o={},debounceMs:i=500}=e,[c,u]=(0,r.useState)([]),[d,m]=(0,r.useState)(!0),[h,p]=(0,r.useState)(!1),[x,g]=(0,r.useState)(null),[f,y]=(0,r.useState)({currentPage:1,totalPages:1,total:0,perPage:20}),[b,v]=(0,r.useState)(!1),[w,j]=(0,r.useState)({search:n||"",courseId:t,difficulty:s,category:a,status:"publish,draft,private",...o}),N=(0,r.useRef)(w),C=(0,r.useRef)(e),k=(0,r.useRef)(null),_=(0,r.useRef)(!0),S=(0,r.useRef)("");(0,r.useEffect)(()=>{N.current=w},[w]),(0,r.useEffect)(()=>{C.current=e},[e]),(0,r.useEffect)(()=>()=>{_.current=!1,k.current&&clearTimeout(k.current)},[]);const E=async(e,t={})=>{try{const s={headers:{"Content-Type":"application/json","X-WP-Nonce":Ge().nonce},credentials:"same-origin",...t},r=await fetch(e,s);if(!r.ok){const e=await r.text();throw new Error(`API Error ${r.status}: ${r.statusText} - ${e}`)}return r}catch(e){throw console.error("API Request Error:",e),e}},$=(0,r.useCallback)(async(e={})=>{const{reset:t=!1,page:s=1,additionalFilters:r={}}=e;try{t&&(m(!0),g(null));const e=Ge(),a=N.current,n=new URLSearchParams({page:s.toString(),per_page:"20",status:a.status||"publish,draft",_embed:"true"});if(a.search&&n.append("search",a.search),a.courseId&&(n.append("meta_query[0][key]","_course_id"),n.append("meta_query[0][value]",a.courseId.toString()),n.append("meta_query[0][compare]","=")),a.difficulty){const e=a.courseId?1:0;n.append(`meta_query[${e}][key]`,"_difficulty_level"),n.append(`meta_query[${e}][value]`,a.difficulty),n.append(`meta_query[${e}][compare]`,"=")}if(a.category){const e=(a.courseId?1:0)+(a.difficulty?1:0);n.append(`meta_query[${e}][key]`,"_quiz_category"),n.append(`meta_query[${e}][value]`,a.category),n.append(`meta_query[${e}][compare]`,"=")}[a.courseId,a.difficulty,a.category].filter(Boolean).length>1&&n.append("meta_query[relation]","AND"),Object.entries(r).forEach(([e,t])=>{null!=t&&""!==t&&n.append(e,t)});const l=`${e.endpoints.quizzes}?${n}`,o=`${l}-${s}-${t}`;if(o===S.current)return void console.log("🚫 Duplicate request prevented:",l);S.current=o,console.log("🚀 Fetching quizzes:",l);const i=await E(l),c=await i.json();if(!_.current)return;const d=i.headers.get("X-WP-Total"),h=i.headers.get("X-WP-TotalPages"),p={currentPage:s,totalPages:h?parseInt(h,10):1,total:d?parseInt(d,10):c.length,perPage:20};y(p),v(s<p.totalPages),u(t||1===s?c:e=>{const t=new Set(e.map(e=>e.id)),s=c.filter(e=>!t.has(e.id));return[...e,...s]}),console.log("✅ Quizzes loaded:",c.length)}catch(e){console.error("❌ Error fetching quizzes:",e),_.current&&(g(e.message||"Failed to fetch quizzes"),(t||1===s)&&(u([]),y({currentPage:1,totalPages:1,total:0,perPage:20}),v(!1)))}finally{_.current&&m(!1)}},[]),M=(0,r.useCallback)((e={})=>{k.current&&clearTimeout(k.current),k.current=setTimeout(()=>{_.current&&$({reset:!0,...e})},i)},[$,i]);(0,r.useEffect)(()=>{l&&(console.log("🎯 Initial quiz load"),$({reset:!0}))},[]),(0,r.useEffect)(()=>{j(e=>{const r={...e,search:n||"",courseId:t,difficulty:s,category:a};return JSON.stringify(r)!==JSON.stringify(e)?r:e})},[n,t,s,a]),(0,r.useEffect)(()=>{l&&(console.log("🔄 Filters changed, debouncing fetch..."),M())},[w,M,l]);const q=(0,r.useCallback)(async e=>{try{p(!0),g(null);const t=Ge(),s={title:e.title||"",content:e.content||"",excerpt:e.excerpt||"",status:e.status||"draft",meta:{_course_id:e.courseId||"",_difficulty_level:e.difficulty||"medium",_quiz_category:e.category||"",_time_limit:e.timeLimit||"0",_max_attempts:e.maxAttempts||"0",_passing_score:e.passingScore||"70",_randomize_questions:e.randomizeQuestions?"yes":"no",_show_results:e.showResults?"yes":"no",_quiz_question_ids:e.questionIds||[],...e.meta}};console.log("🚀 Creating quiz:",s);const r=await E(t.endpoints.quizzes,{method:"POST",body:JSON.stringify(s)}),a=await r.json();return u(e=>[a,...e]),y(e=>({...e,total:e.total+1})),console.log("✅ Quiz created:",a),a}catch(e){throw console.error("❌ Error creating quiz:",e),g(e.message||"Failed to create quiz"),e}finally{p(!1)}},[]),z=(0,r.useCallback)(async e=>{try{g(null);const t=Ge();console.log("🗑️ Deleting quiz:",e),await E(`${t.endpoints.quizzes}/${e}`,{method:"DELETE"}),u(t=>t.filter(t=>t.id!==e)),y(e=>({...e,total:Math.max(0,e.total-1)})),console.log("✅ Quiz deleted")}catch(e){throw console.error("❌ Error deleting quiz:",e),g(e.message||"Failed to delete quiz"),e}},[]),P=(0,r.useCallback)(async e=>{try{g(null);const t=c.find(t=>t.id===e);if(!t)throw new Error("Quiz not found");const s={title:`${t.title?.rendered||t.title} (Copy)`,content:t.content?.rendered||t.content||"",excerpt:t.excerpt?.rendered||t.excerpt||"",status:"draft",courseId:t.meta?._course_id,difficulty:t.meta?._difficulty_level,category:t.meta?._quiz_category,timeLimit:t.meta?._time_limit,maxAttempts:t.meta?._max_attempts,passingScore:t.meta?._passing_score,randomizeQuestions:"yes"===t.meta?._randomize_questions,showResults:"yes"===t.meta?._show_results,questionIds:t.meta?._quiz_question_ids||[],meta:t.meta};return console.log("📋 Duplicating quiz:",e),await q(s)}catch(e){throw console.error("❌ Error duplicating quiz:",e),g(e.message||"Failed to duplicate quiz"),e}},[c,q]),R=(0,r.useCallback)(()=>{b&&!d&&$({page:f.currentPage+1,reset:!1})},[b,d,f.currentPage,$]),T=(0,r.useCallback)(()=>{S.current="",$({reset:!0})},[$]),L=(0,r.useMemo)(()=>({totalQuizzes:c.length,publishedQuizzes:c.filter(e=>"publish"===e.status).length,draftQuizzes:c.filter(e=>"draft"===e.status).length,privateQuizzes:c.filter(e=>"private"===e.status).length,quizzesByDifficulty:c.reduce((e,t)=>{const s=t.meta?._difficulty_level||"medium";return e[s]=(e[s]||0)+1,e},{}),quizzesByCategory:c.reduce((e,t)=>{const s=t.meta?._quiz_category||"assessment";return e[s]=(e[s]||0)+1,e},{}),averageTimeLimit:c.length>0?Math.round(c.reduce((e,t)=>e+parseInt(t.meta?._time_limit||"0"),0)/c.length):0,averagePassingScore:c.length>0?Math.round(c.reduce((e,t)=>e+parseInt(t.meta?._passing_score||"70"),0)/c.length):70,quizzesWithTimeLimit:c.filter(e=>parseInt(e.meta?._time_limit||"0")>0).length,quizzesWithRandomization:c.filter(e=>"yes"===e.meta?._randomize_questions).length,totalAttempts:0,performanceScore:0}),[c]);return{quizzes:c,loading:d,creating:h,error:x,pagination:f,hasMore:b,filters:w,computed:L,createQuiz:q,deleteQuiz:z,duplicateQuiz:P,refreshQuizzes:T,loadMoreQuizzes:R,fetchQuizzes:M}},Ot=Qe("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),Qt=Qe("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Wt=({question:e,viewMode:t="cards",onEdit:s,onDelete:a,onDuplicate:n,onClick:l,quizzes:o=[],showQuiz:i=!0,showStats:c=!0,className:u=""})=>{const d=e.meta?._question_type||"multiple_choice",m=e.meta?._difficulty_level||"medium",h=parseInt(e.meta?._points||"1"),p=parseInt(e.meta?._time_limit||"0"),x=e.meta?._quiz_id,g=e.meta?._question_category,f=e.meta?._explanation,y=(0,r.useMemo)(()=>x&&o.length?o.find(e=>e.id.toString()===x.toString()||e.id===parseInt(x,10)):null,[x,o]),b={timesAsked:Math.floor(100*Math.random())+1,correctAnswers:Math.floor(80*Math.random())+10,averageTime:Math.floor(30*Math.random())+10,difficultyScore:5*Math.random()+1},v=b.timesAsked>0?Math.round(b.correctAnswers/b.timesAsked*100):0,w=e=>{switch(e){case"publish":return"text-green-600 bg-green-100";case"draft":return"text-yellow-600 bg-yellow-100";default:return"text-gray-600 bg-gray-100"}},j=e=>{switch(e){case"easy":return"text-green-600 bg-green-100";case"medium":return"text-yellow-600 bg-yellow-100";case"hard":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},N=e=>{switch(e){case"multiple_choice":return"Multiple Choice";case"true_false":return"True/False";case"short_answer":return"Short Answer";case"essay":return"Essay";case"fill_blank":return"Fill in Blank";default:return"Question"}},C=e=>e>=80?"text-green-600":e>=60?"text-yellow-600":e>=40?"text-orange-600":"text-red-600",k=e=>e?new Date(e).toLocaleDateString():null,_=[{label:"Edit",icon:et,onClick:s,color:"text-blue-600"},{label:"Duplicate",icon:tt,onClick:n,color:"text-green-600"},{label:"Delete",icon:st,onClick:a,color:"text-red-600",divider:!0}].filter(e=>e.onClick),S=(e=>{switch(e){case"multiple_choice":return Ft;case"true_false":return He;case"short_answer":return et;case"essay":return We;case"fill_blank":return Ot;default:return Mt}})(d);return(0,ut.jsx)(dt,{item:e,viewMode:t,actions:_,className:u,clickable:!!l,onClick:l,children:"cards"===t?(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-1 text-sm text-blue-600",children:[(0,ut.jsx)(S,{className:"h-4 w-4"}),(0,ut.jsx)("span",{children:N(d)})]}),g&&(0,ut.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800",children:g}),(0,ut.jsx)("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${j(m)}`,children:m})]}),(0,ut.jsx)("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${w(e.status)}`,children:"publish"===e.status?(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsx)(zt,{className:"h-3 w-3 mr-1"}),"Published"]}):(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsx)(Pt,{className:"h-3 w-3 mr-1"}),e.status]})})]}),(0,ut.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-3 line-clamp-3",children:e.title?.rendered||e.title||"Untitled Question"}),i&&y&&(0,ut.jsxs)("div",{className:"flex items-center space-x-1 text-sm text-gray-600 mb-3",children:[(0,ut.jsx)(We,{className:"h-4 w-4"}),(0,ut.jsxs)("span",{className:"truncate",children:["Quiz: ",y.title?.rendered||y.title]})]}),f&&(0,ut.jsx)("p",{className:"text-sm text-gray-600 mb-4 line-clamp-2",children:f}),(0,ut.jsxs)("div",{className:"space-y-3",children:[(0,ut.jsx)("div",{className:"flex items-center justify-between text-sm text-gray-500",children:(0,ut.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,ut.jsx)(At,{className:"h-4 w-4"}),(0,ut.jsxs)("span",{children:[h," point",1!==h?"s":""]})]}),p>0&&(0,ut.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,ut.jsx)(nt,{className:"h-4 w-4"}),(0,ut.jsxs)("span",{children:[p,"s"]})]})]})}),c&&(0,ut.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-1 text-gray-500",children:[(0,ut.jsx)(kt,{className:"h-4 w-4"}),(0,ut.jsxs)("span",{children:[b.timesAsked," attempts"]})]}),(0,ut.jsxs)("div",{className:`flex items-center space-x-1 ${C(v)}`,children:[(0,ut.jsx)(He,{className:"h-4 w-4"}),(0,ut.jsxs)("span",{children:[v,"% success"]})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-1 text-gray-500",children:[(0,ut.jsx)(nt,{className:"h-4 w-4"}),(0,ut.jsxs)("span",{children:[b.averageTime,"s avg"]})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-1 text-gray-500",children:[(0,ut.jsx)(Qt,{className:"h-4 w-4"}),(0,ut.jsxs)("span",{children:[b.difficultyScore.toFixed(1),"/5"]})]})]}),(0,ut.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-400 pt-2 border-t border-gray-100",children:[(0,ut.jsxs)("span",{children:["Modified ",k(e.modified)]}),(0,ut.jsxs)("span",{children:["ID: ",e.id]})]})]})]}):(0,ut.jsxs)("div",{className:"flex items-center w-full",children:[(0,ut.jsx)("div",{className:"flex-shrink-0 mr-4",children:(0,ut.jsx)("div",{className:"h-10 w-10 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,ut.jsx)(S,{className:"h-5 w-5 text-blue-600"})})}),(0,ut.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ut.jsx)("h3",{className:"text-sm font-medium text-gray-900 truncate",children:e.title?.rendered||e.title||"Untitled Question"}),(0,ut.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[(0,ut.jsx)("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${j(m)}`,children:m}),c&&(0,ut.jsxs)("span",{className:`text-xs font-medium ${C(v)}`,children:[v,"%"]}),(0,ut.jsx)("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${w(e.status)}`,children:e.status})]})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-4 mt-1 text-sm text-gray-500",children:[(0,ut.jsx)("span",{children:N(d)}),i&&y&&(0,ut.jsx)("span",{className:"truncate",children:y.title?.rendered||y.title}),(0,ut.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,ut.jsx)(At,{className:"h-3 w-3"}),(0,ut.jsxs)("span",{children:[h,"pt"]})]}),p>0&&(0,ut.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,ut.jsx)(nt,{className:"h-3 w-3"}),(0,ut.jsxs)("span",{children:[p,"s"]})]}),(0,ut.jsx)("span",{children:k(e.modified)})]})]})]})})},Bt=()=>{const[e,t]=(0,r.useState)("all"),[s,a]=(0,r.useState)("all"),[n,l]=(0,r.useState)("all"),[o,i]=(0,r.useState)("all"),[c,u]=(0,r.useState)(""),[d,m]=(0,r.useState)(!1),[h,p]=(0,r.useState)(!1),[x,g]=(0,r.useState)(null),[f,y]=(0,r.useState)("cards"),{questions:b,loading:v,error:w,pagination:j,computed:N,createQuestion:C,deleteQuestion:k,duplicateQuestion:_,creating:S}=((e={})=>{const{quizId:t=null,type:s=null,difficulty:a=null,category:n=null,search:l="",autoFetch:o=!0,initialFilters:i={},debounceMs:c=500}=e,[u,d]=(0,r.useState)([]),[m,h]=(0,r.useState)(!0),[p,x]=(0,r.useState)(!1),[g,f]=(0,r.useState)(null),[y,b]=(0,r.useState)({currentPage:1,totalPages:1,total:0,perPage:20}),[v,w]=(0,r.useState)(!1),[j,N]=(0,r.useState)({search:l||"",quizId:t,type:s,difficulty:a,category:n,status:"publish,draft,private",...i}),C=(0,r.useRef)(j),k=(0,r.useRef)(e),_=(0,r.useRef)(null),S=(0,r.useRef)(!0),E=(0,r.useRef)("");(0,r.useEffect)(()=>{C.current=j},[j]),(0,r.useEffect)(()=>{k.current=e},[e]),(0,r.useEffect)(()=>()=>{S.current=!1,_.current&&clearTimeout(_.current)},[]);const $=async(e,t={})=>{try{const s={headers:{"Content-Type":"application/json","X-WP-Nonce":Ge().nonce},credentials:"same-origin",...t},r=await fetch(e,s);if(!r.ok){const e=await r.text();throw new Error(`API Error ${r.status}: ${r.statusText} - ${e}`)}return r}catch(e){throw console.error("API Request Error:",e),e}},M=(0,r.useCallback)(async(e={})=>{const{reset:t=!1,page:s=1,additionalFilters:r={}}=e;try{t&&(h(!0),f(null));const e=Ge(),a=C.current,n=new URLSearchParams({page:s.toString(),per_page:"20",status:a.status||"publish,draft",orderby:"date",order:"desc",_embed:"true"});if(a.search&&n.append("search",a.search),a.quizId&&(n.append("meta_query[0][key]","_quiz_id"),n.append("meta_query[0][value]",a.quizId.toString()),n.append("meta_query[0][compare]","="),n.append("meta_query[0][type]","NUMERIC")),a.type){const e=a.quizId?1:0;n.append(`meta_query[${e}][key]`,"_question_type"),n.append(`meta_query[${e}][value]`,a.type),n.append(`meta_query[${e}][compare]`,"=")}if(a.difficulty){const e=(a.quizId?1:0)+(a.type?1:0);n.append(`meta_query[${e}][key]`,"_difficulty_level"),n.append(`meta_query[${e}][value]`,a.difficulty),n.append(`meta_query[${e}][compare]`,"=")}if(a.category){const e=(a.quizId?1:0)+(a.type?1:0)+(a.difficulty?1:0);n.append(`meta_query[${e}][key]`,"_question_category"),n.append(`meta_query[${e}][value]`,a.category),n.append(`meta_query[${e}][compare]`,"=")}[a.quizId,a.type,a.difficulty,a.category].filter(Boolean).length>1&&n.append("meta_query[relation]","AND"),Object.entries(r).forEach(([e,t])=>{null!=t&&""!==t&&n.append(e,t)});const l=`${e.endpoints.questions}?${n}`,o=`${l}-${s}-${t}`;if(o===E.current)return void console.log("🚫 Duplicate question request prevented:",l);E.current=o,console.log("🚀 Fetching questions:",l);const i=await $(l),c=await i.json();if(!S.current)return;const u=i.headers.get("X-WP-Total"),m=i.headers.get("X-WP-TotalPages"),p={currentPage:s,totalPages:m?parseInt(m,10):1,total:u?parseInt(u,10):c.length,perPage:20};b(p),w(s<p.totalPages),d(t||1===s?c:e=>{const t=new Set(e.map(e=>e.id)),s=c.filter(e=>!t.has(e.id));return[...e,...s]}),console.log("✅ Questions loaded:",c.length)}catch(e){console.error("❌ Error fetching questions:",e),S.current&&(f(e.message||"Failed to fetch questions"),(t||1===s)&&(d([]),b({currentPage:1,totalPages:1,total:0,perPage:20}),w(!1)))}finally{S.current&&h(!1)}},[]),q=(0,r.useCallback)((e={})=>{_.current&&clearTimeout(_.current),_.current=setTimeout(()=>{S.current&&M({reset:!0,...e})},c)},[M,c]);(0,r.useEffect)(()=>{o&&(console.log("🎯 Initial question load"),M({reset:!0}))},[]),(0,r.useEffect)(()=>{N(e=>{const r={...e,search:l||"",quizId:t,type:s,difficulty:a,category:n};return JSON.stringify(r)!==JSON.stringify(e)?r:e})},[l,t,s,a,n]),(0,r.useEffect)(()=>{o&&(console.log("🔄 Question filters changed, debouncing fetch..."),q())},[j,q,o]);const z=(0,r.useCallback)(async e=>{try{x(!0),f(null);const t=Ge(),s={title:e.title||"",content:e.content||"",excerpt:e.excerpt||"",status:e.status||"draft",meta:{_quiz_id:e.quizId||"",_question_type:e.type||"multiple_choice",_difficulty_level:e.difficulty||"medium",_question_category:e.category||"",_points:e.points||"1",_time_limit:e.timeLimit||"0",_question_options:e.options||[],_correct_answer:e.correctAnswer||"",_explanation:e.explanation||"",_question_order:e.questionOrder||"1",...e.meta}};console.log("🚀 Creating question:",s);const r=await $(t.endpoints.questions,{method:"POST",body:JSON.stringify(s)}),a=await r.json();return d(e=>[a,...e]),b(e=>({...e,total:e.total+1})),console.log("✅ Question created:",a),a}catch(e){throw console.error("❌ Error creating question:",e),f(e.message||"Failed to create question"),e}finally{x(!1)}},[]),P=(0,r.useCallback)(async e=>{try{f(null);const t=Ge();console.log("🗑️ Deleting question:",e),await $(`${t.endpoints.questions}/${e}`,{method:"DELETE"}),d(t=>t.filter(t=>t.id!==e)),b(e=>({...e,total:Math.max(0,e.total-1)})),console.log("✅ Question deleted")}catch(e){throw console.error("❌ Error deleting question:",e),f(e.message||"Failed to delete question"),e}},[]),R=(0,r.useCallback)(async e=>{try{f(null);const t=u.find(t=>t.id===e);if(!t)throw new Error("Question not found");const s={title:`${t.title?.rendered||t.title} (Copy)`,content:t.content?.rendered||t.content||"",excerpt:t.excerpt?.rendered||t.excerpt||"",status:"draft",quizId:t.meta?._quiz_id,type:t.meta?._question_type,difficulty:t.meta?._difficulty_level,category:t.meta?._question_category,points:t.meta?._points,timeLimit:t.meta?._time_limit,options:t.meta?._question_options,correctAnswer:t.meta?._correct_answer,explanation:t.meta?._explanation,questionOrder:t.meta?._question_order,meta:t.meta};return console.log("📋 Duplicating question:",e),await z(s)}catch(e){throw console.error("❌ Error duplicating question:",e),f(e.message||"Failed to duplicate question"),e}},[u,z]),T=(0,r.useCallback)(()=>{v&&!m&&M({page:y.currentPage+1,reset:!1})},[v,m,y.currentPage,M]),L=(0,r.useCallback)(()=>{E.current="",M({reset:!0})},[M]),D=(0,r.useMemo)(()=>({totalQuestions:u.length,publishedQuestions:u.filter(e=>"publish"===e.status).length,draftQuestions:u.filter(e=>"draft"===e.status).length,privateQuestions:u.filter(e=>"private"===e.status).length,questionsByType:u.reduce((e,t)=>{const s=t.meta?._question_type||"multiple_choice";return e[s]=(e[s]||0)+1,e},{}),questionsByDifficulty:u.reduce((e,t)=>{const s=t.meta?._difficulty_level||"medium";return e[s]=(e[s]||0)+1,e},{}),questionsByCategory:u.reduce((e,t)=>{const s=t.meta?._question_category||"general";return e[s]=(e[s]||0)+1,e},{}),averagePoints:u.length>0?Math.round(u.reduce((e,t)=>e+parseInt(t.meta?._points||"1"),0)/u.length):1,totalPoints:u.reduce((e,t)=>e+parseInt(t.meta?._points||"1"),0),questionsWithTimeLimit:u.filter(e=>parseInt(e.meta?._time_limit||"0")>0).length,questionsWithExplanation:u.filter(e=>e.meta?._explanation&&""!==e.meta._explanation.trim()).length,multipleChoiceQuestions:u.filter(e=>"multiple_choice"===e.meta?._question_type).length,trueFalseQuestions:u.filter(e=>"true_false"===e.meta?._question_type).length,essayQuestions:u.filter(e=>"essay"===e.meta?._question_type).length}),[u]);return{questions:u,loading:m,creating:p,error:g,pagination:y,hasMore:v,filters:j,computed:D,createQuestion:z,deleteQuestion:P,duplicateQuestion:R,refreshQuestions:L,loadMoreQuestions:T,fetchQuestions:q}})({search:c,quizId:"all"!==e?e:null,type:"all"!==s?s:null,difficulty:"all"!==n?n:null,category:"all"!==o?o:null,autoFetch:!0}),{quizzes:E,loading:$}=Ut({status:"publish,draft",perPage:100}),M=(0,r.useMemo)(()=>E.filter(e=>e.title&&(e.title.rendered||e.title)).map(e=>({...e,title:e.title.rendered||e.title})),[E]),q=(0,r.useMemo)(()=>["all","multiple_choice","true_false","short_answer","essay","fill_blank"],[]),z=(0,r.useMemo)(()=>["all","easy","medium","hard"],[]),P=(0,r.useMemo)(()=>["all","general","technical","behavioral","analytical","logical"],[]),R=(0,r.useMemo)(()=>{const e=b.reduce((e,t)=>{const s=t.meta?._question_type||"multiple_choice";return e[s]=(e[s]||0)+1,e},{}),t=b.reduce((e,t)=>e+parseInt(t.meta?._points||"1"),0),s=b.length>0?Math.round(t/b.length*10)/10:0,r=Math.floor(40*Math.random())+60;return[{label:"Total Questions",value:N.totalQuestions||b.length,icon:Mt,iconColor:"text-gray-400"},{label:"Published",value:N.publishedQuestions||b.filter(e=>"publish"===e.status).length,icon:zt,iconColor:"text-green-400"},{label:"Draft",value:N.draftQuestions||b.filter(e=>"draft"===e.status).length,icon:Pt,iconColor:"text-yellow-400"},{label:"Avg. Points",value:s>0?s:"--",icon:At,iconColor:"text-purple-400"},{label:"Success Rate",value:`${r}%`,icon:He,iconColor:"text-blue-400"},{label:"Multiple Choice",value:e.multiple_choice||0,icon:Ft,iconColor:"text-green-500"},{label:"Performance",value:N.performanceScore||"--",icon:Ve,iconColor:"text-indigo-400"}]},[b,N]),T=(0,r.useCallback)(e=>{t(e)},[]),L=(0,r.useCallback)(e=>{a(e)},[]),D=(0,r.useCallback)(e=>{l(e)},[]),A=(0,r.useCallback)(e=>{i(e)},[]),F=(0,r.useCallback)(e=>{u(e)},[]),I=((0,r.useCallback)(async e=>{try{const t=await C(e);return m(!1),t}catch(e){throw console.error("Error creating question:",e),e}},[C]),(0,r.useCallback)(e=>{g(e),p(!0)},[])),U=(0,r.useCallback)(async()=>{if(x)try{await k(x.id),p(!1),g(null)}catch(e){console.error("Error deleting question:",e)}},[x,k]),O=(0,r.useCallback)(async e=>{try{await _(e.id)}catch(e){console.error("Error duplicating question:",e)}},[_]),Q=(0,r.useCallback)(e=>{console.log("Navigate to question details:",e.id)},[]),W=e=>{switch(e){case"multiple_choice":return"Multiple Choice";case"true_false":return"True/False";case"short_answer":return"Short Answer";case"essay":return"Essay";case"fill_blank":return"Fill in Blank";default:return e.charAt(0).toUpperCase()+e.slice(1).replace("_"," ")}},B={icon:Mt,title:"No questions found",description:"all"!==e||"all"!==s||"all"!==n||"all"!==o||c?"No questions match your current filters.":"You haven't created any questions yet.",actionText:"Create First Question"};return w?(0,ut.jsxs)("div",{className:"text-center py-12",children:[(0,ut.jsx)("div",{className:"text-red-600 mb-4",children:"Error loading questions"}),(0,ut.jsx)("p",{className:"text-gray-600",children:w})]}):(0,ut.jsxs)("div",{className:"p-6",children:[(0,ut.jsx)(bt,{title:"Questions Manager",description:"Manage and organize your quiz questions",createButtonText:"Create Question",onCreateClick:()=>m(!0),statistics:R,items:b,loading:v,viewMode:f,onViewModeChange:y,filtersComponent:(0,ut.jsxs)("div",{className:"p-4",children:[(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[(0,ut.jsxs)("div",{className:"relative",children:[(0,ut.jsx)("label",{htmlFor:"search",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search Questions"}),(0,ut.jsxs)("div",{className:"relative",children:[(0,ut.jsx)("input",{id:"search",type:"text",value:c,onChange:e=>F(e.target.value),placeholder:"Search by question text...",className:"block w-full pl-10 pr-3 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"}),(0,ut.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,ut.jsx)(Ke,{className:"h-5 w-5 text-gray-400"})})]})]}),(0,ut.jsxs)("div",{className:"relative",children:[(0,ut.jsx)("label",{htmlFor:"quiz-select",className:"block text-sm font-medium text-gray-700 mb-1",children:"Quiz"}),(0,ut.jsxs)("div",{className:"relative",children:[(0,ut.jsxs)("select",{id:"quiz-select",value:e,onChange:e=>T(e.target.value),className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md appearance-none",disabled:$,children:[(0,ut.jsx)("option",{value:"all",children:"All Quizzes"}),M.map(e=>(0,ut.jsx)("option",{value:e.id,children:e.title},e.id))]}),(0,ut.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none",children:(0,ut.jsx)(It,{className:"h-5 w-5 text-gray-400"})})]})]}),(0,ut.jsxs)("div",{className:"relative",children:[(0,ut.jsx)("label",{htmlFor:"type-select",className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),(0,ut.jsxs)("div",{className:"relative",children:[(0,ut.jsxs)("select",{id:"type-select",value:s,onChange:e=>L(e.target.value),className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md appearance-none",children:[(0,ut.jsx)("option",{value:"all",children:"All Types"}),q.slice(1).map(e=>(0,ut.jsx)("option",{value:e,children:W(e)},e))]}),(0,ut.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none",children:(0,ut.jsx)(It,{className:"h-5 w-5 text-gray-400"})})]})]}),(0,ut.jsxs)("div",{className:"relative",children:[(0,ut.jsx)("label",{htmlFor:"difficulty-select",className:"block text-sm font-medium text-gray-700 mb-1",children:"Difficulty"}),(0,ut.jsxs)("div",{className:"relative",children:[(0,ut.jsxs)("select",{id:"difficulty-select",value:n,onChange:e=>D(e.target.value),className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md appearance-none",children:[(0,ut.jsx)("option",{value:"all",children:"All Levels"}),z.slice(1).map(e=>(0,ut.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))]}),(0,ut.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none",children:(0,ut.jsx)(It,{className:"h-5 w-5 text-gray-400"})})]})]}),(0,ut.jsxs)("div",{className:"relative",children:[(0,ut.jsx)("label",{htmlFor:"category-select",className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),(0,ut.jsxs)("div",{className:"relative",children:[(0,ut.jsxs)("select",{id:"category-select",value:o,onChange:e=>A(e.target.value),className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md appearance-none",children:[(0,ut.jsx)("option",{value:"all",children:"All Categories"}),P.slice(1).map(e=>(0,ut.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))]}),(0,ut.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none",children:(0,ut.jsx)(It,{className:"h-5 w-5 text-gray-400"})})]})]})]}),("all"!==e||"all"!==s||"all"!==n||"all"!==o||c)&&(0,ut.jsxs)("div",{className:"mt-4 flex flex-wrap items-center gap-2",children:[(0,ut.jsx)("span",{className:"text-sm text-gray-500",children:"Active filters:"}),c&&(0,ut.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:['Search: "',c,'"',(0,ut.jsx)("button",{onClick:()=>u(""),className:"ml-1 text-blue-600 hover:text-blue-800",children:"×"})]}),"all"!==e&&(0,ut.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[M.find(t=>t.id.toString()===e)?.title||"Quiz",(0,ut.jsx)("button",{onClick:()=>t("all"),className:"ml-1 text-green-600 hover:text-green-800",children:"×"})]}),"all"!==s&&(0,ut.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:[W(s),(0,ut.jsx)("button",{onClick:()=>a("all"),className:"ml-1 text-purple-600 hover:text-purple-800",children:"×"})]}),"all"!==n&&(0,ut.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[n,(0,ut.jsx)("button",{onClick:()=>l("all"),className:"ml-1 text-yellow-600 hover:text-yellow-800",children:"×"})]}),"all"!==o&&(0,ut.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800",children:[o,(0,ut.jsx)("button",{onClick:()=>i("all"),className:"ml-1 text-indigo-600 hover:text-indigo-800",children:"×"})]})]})]}),emptyState:B,showStatistics:!0,showViewToggle:!0,showCreateButton:!0,showItemCount:!0,children:b.map(e=>(0,ut.jsx)(Wt,{question:e,viewMode:f,onEdit:e=>console.log("Edit question:",e),onDelete:I,onDuplicate:O,onClick:Q,quizzes:M,showQuiz:!0,showStats:!0},e.id))}),(0,ut.jsx)(jt,{isOpen:h,onClose:()=>{p(!1),g(null)},onConfirm:U,title:"Delete Question",message:"Are you sure you want to delete this question? This action cannot be undone and will affect any quizzes that include this question."})]})},Vt=({quiz:e,viewMode:t="cards",onEdit:s,onDelete:a,onDuplicate:n,onClick:l,courses:o=[],showCourse:i=!0,showStats:c=!0,className:u=""})=>{const d=parseInt(e.meta?._time_limit||"0"),m=parseInt(e.meta?._max_attempts||"0"),h=parseInt(e.meta?._passing_score||"70"),p="yes"===e.meta?._randomize_questions,x="yes"===e.meta?._show_results,g=e.meta?._course_id,f=e.meta?._quiz_category,y=e.meta?._difficulty_level||"medium",b=(0,r.useMemo)(()=>g&&o.length?o.find(e=>e.id.toString()===g.toString()||e.id===parseInt(g,10)):null,[g,o]),v={totalQuestions:Math.floor(20*Math.random())+5,totalAttempts:Math.floor(200*Math.random())+10,averageScore:Math.floor(30*Math.random())+70,completionRate:Math.floor(40*Math.random())+60,averageTime:Math.floor(25*Math.random())+5,passRate:Math.floor(40*Math.random())+60},w=e=>{switch(e){case"publish":return"text-green-600 bg-green-100";case"draft":return"text-yellow-600 bg-yellow-100";default:return"text-gray-600 bg-gray-100"}},j=e=>{switch(e){case"easy":return"text-green-600 bg-green-100";case"medium":return"text-yellow-600 bg-yellow-100";case"hard":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},N=e=>e>=90?"text-green-600":e>=80?"text-blue-600":e>=70?"text-yellow-600":e>=60?"text-orange-600":"text-red-600",C=e=>{if(e<60)return`${e}m`;const t=Math.floor(e/60),s=e%60;return s>0?`${t}h ${s}m`:`${t}h`},k=e=>e?new Date(e).toLocaleDateString():null,_=[{label:"Edit",icon:et,onClick:s,color:"text-blue-600"},{label:"Preview",icon:Rt,onClick:e=>console.log("Preview quiz:",e),color:"text-green-600"},{label:"Duplicate",icon:tt,onClick:n,color:"text-purple-600"},{label:"Delete",icon:st,onClick:a,color:"text-red-600",divider:!0}].filter(e=>e.onClick);return(0,ut.jsx)(dt,{item:e,viewMode:t,actions:_,className:u,clickable:!!l,onClick:l,children:"cards"===t?(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-1 text-sm text-indigo-600",children:[(0,ut.jsx)(Mt,{className:"h-4 w-4"}),(0,ut.jsx)("span",{children:"Quiz"})]}),f&&(0,ut.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:f}),(0,ut.jsx)("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${j(y)}`,children:y})]}),(0,ut.jsx)("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${w(e.status)}`,children:"publish"===e.status?(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsx)(zt,{className:"h-3 w-3 mr-1"}),"Published"]}):(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsx)(Pt,{className:"h-3 w-3 mr-1"}),e.status]})})]}),(0,ut.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2 line-clamp-2",children:e.title?.rendered||e.title||"Untitled Quiz"}),e.excerpt?.rendered&&(0,ut.jsx)("p",{className:"text-sm text-gray-600 mb-4 line-clamp-3",children:e.excerpt.rendered.replace(/<[^>]*>/g,"")}),i&&b&&(0,ut.jsxs)("div",{className:"flex items-center space-x-1 text-sm text-gray-600 mb-3",children:[(0,ut.jsx)(We,{className:"h-4 w-4"}),(0,ut.jsxs)("span",{className:"truncate",children:["Course: ",b.title?.rendered||b.title]})]}),(0,ut.jsxs)("div",{className:"space-y-3",children:[(0,ut.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-1 text-gray-600",children:[(0,ut.jsx)(Mt,{className:"h-4 w-4"}),(0,ut.jsxs)("span",{children:[v.totalQuestions," questions"]})]}),d>0&&(0,ut.jsxs)("div",{className:"flex items-center space-x-1 text-gray-600",children:[(0,ut.jsx)(nt,{className:"h-4 w-4"}),(0,ut.jsx)("span",{children:C(d)})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-1 text-gray-600",children:[(0,ut.jsx)(He,{className:"h-4 w-4"}),(0,ut.jsxs)("span",{children:[h,"% to pass"]})]}),m>0&&(0,ut.jsxs)("div",{className:"flex items-center space-x-1 text-gray-600",children:[(0,ut.jsx)(kt,{className:"h-4 w-4"}),(0,ut.jsxs)("span",{children:[m," attempts"]})]})]}),(0,ut.jsxs)("div",{className:"flex flex-wrap gap-2",children:[p&&(0,ut.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:[(0,ut.jsx)(At,{className:"h-3 w-3 mr-1"}),"Randomized"]}),x&&(0,ut.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[(0,ut.jsx)(Ft,{className:"h-3 w-3 mr-1"}),"Shows Results"]})]}),c&&(0,ut.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm pt-2 border-t border-gray-100",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-1 text-gray-500",children:[(0,ut.jsx)(ot,{className:"h-4 w-4"}),(0,ut.jsxs)("span",{children:[v.totalAttempts," attempts"]})]}),(0,ut.jsxs)("div",{className:`flex items-center space-x-1 ${N(v.averageScore)}`,children:[(0,ut.jsx)(Je,{className:"h-4 w-4"}),(0,ut.jsxs)("span",{children:[v.averageScore,"% avg"]})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-1 text-gray-500",children:[(0,ut.jsx)(nt,{className:"h-4 w-4"}),(0,ut.jsxs)("span",{children:[v.averageTime,"m avg time"]})]}),(0,ut.jsxs)("div",{className:`flex items-center space-x-1 ${N(v.passRate)}`,children:[(0,ut.jsx)(Ve,{className:"h-4 w-4"}),(0,ut.jsxs)("span",{children:[v.passRate,"% pass"]})]})]}),(0,ut.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-400 pt-2 border-t border-gray-100",children:[(0,ut.jsxs)("span",{children:["Modified ",k(e.modified)]}),(0,ut.jsxs)("span",{children:["ID: ",e.id]})]})]})]}):(0,ut.jsxs)("div",{className:"flex items-center w-full",children:[(0,ut.jsx)("div",{className:"flex-shrink-0 mr-4",children:(0,ut.jsx)("div",{className:"h-10 w-10 bg-indigo-100 rounded-lg flex items-center justify-center",children:(0,ut.jsx)(Mt,{className:"h-5 w-5 text-indigo-600"})})}),(0,ut.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ut.jsx)("h3",{className:"text-sm font-medium text-gray-900 truncate",children:e.title?.rendered||e.title||"Untitled Quiz"}),(0,ut.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[(0,ut.jsx)("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${j(y)}`,children:y}),c&&(0,ut.jsxs)("span",{className:`text-xs font-medium ${N(v.averageScore)}`,children:[v.averageScore,"%"]}),(0,ut.jsx)("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${w(e.status)}`,children:e.status})]})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-4 mt-1 text-sm text-gray-500",children:[(0,ut.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,ut.jsx)(Mt,{className:"h-3 w-3"}),(0,ut.jsxs)("span",{children:[v.totalQuestions,"q"]})]}),d>0&&(0,ut.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,ut.jsx)(nt,{className:"h-3 w-3"}),(0,ut.jsx)("span",{children:C(d)})]}),i&&b&&(0,ut.jsx)("span",{className:"truncate",children:b.title?.rendered||b.title}),c&&(0,ut.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,ut.jsx)(ot,{className:"h-3 w-3"}),(0,ut.jsx)("span",{children:v.totalAttempts})]}),(0,ut.jsx)("span",{children:k(e.modified)})]})]})]})})},Ht=()=>{const[e,t]=(0,r.useState)("all"),[s,a]=(0,r.useState)("all"),[n,l]=(0,r.useState)("all"),[o,i]=(0,r.useState)(""),[c,u]=(0,r.useState)(!1),[d,m]=(0,r.useState)(!1),[h,p]=(0,r.useState)(null),[x,g]=(0,r.useState)("cards"),{quizzes:f,loading:y,error:b,pagination:v,computed:w,createQuiz:j,deleteQuiz:N,duplicateQuiz:C,creating:k}=Ut({search:o,courseId:"all"!==e?e:null,difficulty:"all"!==s?s:null,category:"all"!==n?n:null,autoFetch:!0}),{courses:_,loading:S}=Ze({status:"publish,draft",perPage:100}),E=(0,r.useMemo)(()=>_.filter(e=>e.title&&(e.title.rendered||e.title)).map(e=>({...e,title:e.title.rendered||e.title})),[_]),$=(0,r.useMemo)(()=>["all","easy","medium","hard"],[]),M=(0,r.useMemo)(()=>["all","assessment","practice","final_exam","checkpoint","review"],[]),q=(0,r.useMemo)(()=>{f.reduce((e,t)=>{const s=t.meta?._difficulty_level||"medium";return e[s]=(e[s]||0)+1,e},{});const e=f.reduce(e=>e+(Math.floor(20*Math.random())+5),0),t=f.length>0?Math.round(e/f.length):0,s=f.reduce(e=>e+Math.floor(100*Math.random())+10,0),r=Math.floor(30*Math.random())+70,a=Math.floor(40*Math.random())+60;return[{label:"Total Quizzes",value:w.totalQuizzes||f.length,icon:Mt,iconColor:"text-gray-400"},{label:"Published",value:w.publishedQuizzes||f.filter(e=>"publish"===e.status).length,icon:zt,iconColor:"text-green-400"},{label:"Draft",value:w.draftQuizzes||f.filter(e=>"draft"===e.status).length,icon:Pt,iconColor:"text-yellow-400"},{label:"Avg. Questions",value:t>0?t:"--",icon:kt,iconColor:"text-blue-400"},{label:"Total Attempts",value:w.totalAttempts||s,icon:ot,iconColor:"text-purple-400"},{label:"Avg. Score",value:`${r}%`,icon:Je,iconColor:"text-yellow-500"},{label:"Pass Rate",value:`${a}%`,icon:Ve,iconColor:"text-green-500"}]},[f,w]),z=(0,r.useCallback)(e=>{t(e)},[]),P=(0,r.useCallback)(e=>{a(e)},[]),R=(0,r.useCallback)(e=>{l(e)},[]),T=(0,r.useCallback)(e=>{i(e)},[]),L=((0,r.useCallback)(async e=>{try{const t=await j(e);return u(!1),t}catch(e){throw console.error("Error creating quiz:",e),e}},[j]),(0,r.useCallback)(e=>{p(e),m(!0)},[])),D=(0,r.useCallback)(async()=>{if(h)try{await N(h.id),m(!1),p(null)}catch(e){console.error("Error deleting quiz:",e)}},[h,N]),A=(0,r.useCallback)(async e=>{try{await C(e.id)}catch(e){console.error("Error duplicating quiz:",e)}},[C]),F=(0,r.useCallback)(e=>{console.log("Navigate to quiz details:",e.id)},[]),I=e=>{switch(e){case"assessment":return"Assessment";case"practice":return"Practice";case"final_exam":return"Final Exam";case"checkpoint":return"Checkpoint";case"review":return"Review";default:return e.charAt(0).toUpperCase()+e.slice(1).replace("_"," ")}},U={icon:Mt,title:"No quizzes found",description:"all"!==e||"all"!==s||"all"!==n||o?"No quizzes match your current filters.":"You haven't created any quizzes yet.",actionText:"Create First Quiz"};return b?(0,ut.jsxs)("div",{className:"text-center py-12",children:[(0,ut.jsx)("div",{className:"text-red-600 mb-4",children:"Error loading quizzes"}),(0,ut.jsx)("p",{className:"text-gray-600",children:b})]}):(0,ut.jsxs)("div",{className:"p-6",children:[(0,ut.jsx)(bt,{title:"Quizzes Manager",description:"Manage and organize your assessments and quizzes",createButtonText:"Create Quiz",onCreateClick:()=>u(!0),statistics:q,items:f,loading:y,viewMode:x,onViewModeChange:g,filtersComponent:(0,ut.jsxs)("div",{className:"p-4",children:[(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,ut.jsxs)("div",{className:"relative",children:[(0,ut.jsx)("label",{htmlFor:"search",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search Quizzes"}),(0,ut.jsxs)("div",{className:"relative",children:[(0,ut.jsx)("input",{id:"search",type:"text",value:o,onChange:e=>T(e.target.value),placeholder:"Search by title, description...",className:"block w-full pl-10 pr-3 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"}),(0,ut.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,ut.jsx)(Ke,{className:"h-5 w-5 text-gray-400"})})]})]}),(0,ut.jsxs)("div",{className:"relative",children:[(0,ut.jsx)("label",{htmlFor:"course-select",className:"block text-sm font-medium text-gray-700 mb-1",children:"Course"}),(0,ut.jsxs)("div",{className:"relative",children:[(0,ut.jsxs)("select",{id:"course-select",value:e,onChange:e=>z(e.target.value),className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md appearance-none",disabled:S,children:[(0,ut.jsx)("option",{value:"all",children:"All Courses"}),E.map(e=>(0,ut.jsx)("option",{value:e.id,children:e.title},e.id))]}),(0,ut.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none",children:(0,ut.jsx)(It,{className:"h-5 w-5 text-gray-400"})})]})]}),(0,ut.jsxs)("div",{className:"relative",children:[(0,ut.jsx)("label",{htmlFor:"difficulty-select",className:"block text-sm font-medium text-gray-700 mb-1",children:"Difficulty"}),(0,ut.jsxs)("div",{className:"relative",children:[(0,ut.jsxs)("select",{id:"difficulty-select",value:s,onChange:e=>P(e.target.value),className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md appearance-none",children:[(0,ut.jsx)("option",{value:"all",children:"All Levels"}),$.slice(1).map(e=>(0,ut.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))]}),(0,ut.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none",children:(0,ut.jsx)(It,{className:"h-5 w-5 text-gray-400"})})]})]}),(0,ut.jsxs)("div",{className:"relative",children:[(0,ut.jsx)("label",{htmlFor:"category-select",className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),(0,ut.jsxs)("div",{className:"relative",children:[(0,ut.jsxs)("select",{id:"category-select",value:n,onChange:e=>R(e.target.value),className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md appearance-none",children:[(0,ut.jsx)("option",{value:"all",children:"All Categories"}),M.slice(1).map(e=>(0,ut.jsx)("option",{value:e,children:I(e)},e))]}),(0,ut.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none",children:(0,ut.jsx)(It,{className:"h-5 w-5 text-gray-400"})})]})]})]}),("all"!==e||"all"!==s||"all"!==n||o)&&(0,ut.jsxs)("div",{className:"mt-4 flex flex-wrap items-center gap-2",children:[(0,ut.jsx)("span",{className:"text-sm text-gray-500",children:"Active filters:"}),o&&(0,ut.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:['Search: "',o,'"',(0,ut.jsx)("button",{onClick:()=>i(""),className:"ml-1 text-blue-600 hover:text-blue-800",children:"×"})]}),"all"!==e&&(0,ut.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[E.find(t=>t.id.toString()===e)?.title||"Course",(0,ut.jsx)("button",{onClick:()=>t("all"),className:"ml-1 text-green-600 hover:text-green-800",children:"×"})]}),"all"!==s&&(0,ut.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[s,(0,ut.jsx)("button",{onClick:()=>a("all"),className:"ml-1 text-yellow-600 hover:text-yellow-800",children:"×"})]}),"all"!==n&&(0,ut.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:[I(n),(0,ut.jsx)("button",{onClick:()=>l("all"),className:"ml-1 text-purple-600 hover:text-purple-800",children:"×"})]})]})]}),emptyState:U,showStatistics:!0,showViewToggle:!0,showCreateButton:!0,showItemCount:!0,children:f.map(e=>(0,ut.jsx)(Vt,{quiz:e,viewMode:x,onEdit:e=>console.log("Edit quiz:",e),onDelete:L,onDuplicate:A,onClick:F,courses:E,showCourse:!0,showStats:!0},e.id))}),(0,ut.jsx)(jt,{isOpen:d,onClose:()=>{m(!1),p(null)},onConfirm:D,title:"Delete Quiz",message:`Are you sure you want to delete the quiz "${h?.title?.rendered||h?.title||"this quiz"}"? This action cannot be undone and will also delete all associated questions and results.`})]})},Jt=Qe("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]),Xt=Qe("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),Yt=Qe("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),Kt=Qe("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),Gt=Qe("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),Zt=Qe("user-minus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),es=Qe("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),ts=Qe("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),ss=Qe("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]),rs=({user:e,viewMode:t="cards",onEnroll:s,onUnenroll:r,onUpdateRole:a,onView:n,showEnrollment:l=!0,showProgress:o=!0,courseId:i=null,className:c=""})=>{const u=e.roles?.[0]||"subscriber",d=e.enrollmentData?.isEnrolled||!1,m=e.enrollmentData?.progress||0,h=e.enrollmentData?.enrollmentDate,p=e.enrollmentData?.lastActivity,x=e.date_registered||e.registered,g=e.avatar_urls?.[96]||e.avatar_urls?.[48]||null,f=e.name?e.name.split(" ").map(e=>e.charAt(0)).join("").toUpperCase():e.username?.charAt(0).toUpperCase()||"U",y=e=>{switch(e){case"administrator":return"text-red-600 bg-red-100";case"editor":return"text-purple-600 bg-purple-100";case"author":return"text-blue-600 bg-blue-100";case"contributor":return"text-green-600 bg-green-100";default:return"text-gray-600 bg-gray-100"}},b=e=>e?new Date(e).toLocaleDateString():"N/A",v=(e=>{if(!e)return{status:"inactive",label:"Never",color:"text-gray-500"};const t=new Date(e),s=new Date,r=Math.floor((s-t)/864e5);return 0===r?{status:"today",label:"Today",color:"text-green-600"}:r<=7?{status:"recent",label:`${r}d ago`,color:"text-green-500"}:r<=30?{status:"moderate",label:`${r}d ago`,color:"text-yellow-500"}:{status:"inactive",label:`${r}d ago`,color:"text-red-500"}})(p),w=[{label:"View Details",icon:zt,onClick:n,color:"text-blue-600"},...l&&i?[d?{label:"Unenroll",icon:Zt,onClick:()=>r?.(e.id,i),color:"text-red-600"}:{label:"Enroll",icon:Xt,onClick:()=>s?.(e.id,i),color:"text-green-600"}]:[],{label:"Update Role",icon:es,onClick:()=>a?.(e.id),color:"text-purple-600"}].filter(e=>e.onClick);return(0,ut.jsx)(dt,{item:e,viewMode:t,actions:w,className:c,clickable:!!n,onClick:n?()=>n(e):void 0,children:"cards"===t?(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsxs)("div",{className:"flex items-center mb-4",children:[(0,ut.jsx)("div",{className:"flex-shrink-0 mr-3",children:g?(0,ut.jsx)("img",{src:g,alt:e.name||e.username,className:"h-12 w-12 rounded-full object-cover"}):(0,ut.jsx)("div",{className:"h-12 w-12 rounded-full bg-gray-200 flex items-center justify-center",children:(0,ut.jsx)("span",{className:"text-lg font-medium text-gray-600",children:f})})}),(0,ut.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,ut.jsx)("h3",{className:"text-lg font-semibold text-gray-900 truncate",children:e.name||e.username||"Unknown User"}),(0,ut.jsxs)("div",{className:"flex items-center space-x-2 mt-1",children:[(0,ut.jsxs)("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${y(u)}`,children:[(0,ut.jsx)(Yt,{className:"h-3 w-3 mr-1"}),u]}),l&&i&&(0,ut.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium "+(d?"text-green-600 bg-green-100":"text-gray-600 bg-gray-100"),children:d?(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsx)(Ft,{className:"h-3 w-3 mr-1"}),"Enrolled"]}):(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsx)(ts,{className:"h-3 w-3 mr-1"}),"Not Enrolled"]})})]})]})]}),(0,ut.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,ut.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,ut.jsx)(ss,{className:"h-4 w-4 mr-2"}),(0,ut.jsx)("span",{className:"truncate",children:e.email||"No email"})]}),(0,ut.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,ut.jsx)(it,{className:"h-4 w-4 mr-2"}),(0,ut.jsxs)("span",{children:["Registered ",b(x)]})]}),(0,ut.jsxs)("div",{className:"flex items-center text-sm",children:[(0,ut.jsx)(Jt,{className:"h-4 w-4 mr-2 text-gray-400"}),(0,ut.jsxs)("span",{className:v.color,children:["Last active: ",v.label]})]})]}),l&&i&&d&&(0,ut.jsxs)("div",{className:"space-y-3 mb-4 p-3 bg-blue-50 rounded-lg",children:[(0,ut.jsx)("h4",{className:"text-sm font-medium text-blue-900",children:"Course Enrollment"}),(0,ut.jsxs)("div",{className:"flex items-center text-sm text-blue-700",children:[(0,ut.jsx)(it,{className:"h-3 w-3 mr-2"}),(0,ut.jsxs)("span",{children:["Enrolled ",b(h)]})]}),o&&(0,ut.jsxs)("div",{className:"space-y-1",children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,ut.jsx)("span",{className:"text-blue-700",children:"Progress"}),(0,ut.jsxs)("span",{className:"font-medium text-blue-900",children:[m,"%"]})]}),(0,ut.jsx)("div",{className:"w-full bg-blue-200 rounded-full h-2",children:(0,ut.jsx)("div",{className:`h-2 rounded-full transition-all duration-300 ${(e=>e>=80?"bg-green-500":e>=50?"bg-yellow-500":e>=20?"bg-orange-500":"bg-red-500")(m)}`,style:{width:`${m}%`}})})]})]}),(0,ut.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-400 pt-3 border-t border-gray-100",children:[(0,ut.jsxs)("span",{children:["ID: ",e.id]}),(0,ut.jsx)("span",{children:e.username})]})]}):(0,ut.jsxs)("div",{className:"flex items-center w-full",children:[(0,ut.jsx)("div",{className:"flex-shrink-0 mr-4",children:g?(0,ut.jsx)("img",{src:g,alt:e.name||e.username,className:"h-10 w-10 rounded-full object-cover"}):(0,ut.jsx)("div",{className:"h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center",children:(0,ut.jsx)("span",{className:"text-sm font-medium text-gray-600",children:f})})}),(0,ut.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ut.jsx)("h3",{className:"text-lg font-semibold text-gray-900 truncate",children:e.name||e.username||"Unknown User"}),(0,ut.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[(0,ut.jsx)("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${y(u)}`,children:u}),l&&i&&(0,ut.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium "+(d?"text-green-600 bg-green-100":"text-gray-600 bg-gray-100"),children:d?"Enrolled":"Not Enrolled"})]})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-4 mt-1 text-sm text-gray-500",children:[(0,ut.jsx)("span",{className:"truncate",children:e.email}),(0,ut.jsxs)("span",{children:["Registered ",b(x)]}),(0,ut.jsx)("span",{className:v.color,children:v.label}),o&&d&&(0,ut.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,ut.jsx)(Ve,{className:"h-3 w-3"}),(0,ut.jsxs)("span",{children:[m,"%"]})]})]})]})]})})},as=()=>{const[e,t]=(0,r.useState)("all"),[s,a]=(0,r.useState)("all"),[n,l]=(0,r.useState)("all"),[o,i]=(0,r.useState)(""),[c,u]=(0,r.useState)("cards"),{users:d,loading:m,updating:h,error:p,pagination:x,computed:g,enrollUserInCourse:f,unenrollUserFromCourse:y,updateUserRole:b,refreshUsers:v}=((e={})=>{const{role:t=null,courseId:s=null,enrollmentStatus:a=null,search:n="",autoFetch:l=!0,initialFilters:o={},debounceMs:i=500}=e,[c,u]=(0,r.useState)([]),[d,m]=(0,r.useState)(!0),[h,p]=(0,r.useState)(!1),[x,g]=(0,r.useState)(null),[f,y]=(0,r.useState)({currentPage:1,totalPages:1,total:0,perPage:20}),[b,v]=(0,r.useState)(!1),[w,j]=(0,r.useState)({search:n||"",role:t,courseId:s,enrollmentStatus:a,orderBy:"registered",order:"desc",...o}),N=(0,r.useRef)(w),C=(0,r.useRef)(e),k=(0,r.useRef)(null),_=(0,r.useRef)(!0),S=(0,r.useRef)("");(0,r.useEffect)(()=>{N.current=w},[w]),(0,r.useEffect)(()=>{C.current=e},[e]),(0,r.useEffect)(()=>()=>{_.current=!1,k.current&&clearTimeout(k.current)},[]);const E=async(e,t={})=>{try{const s={headers:{"Content-Type":"application/json","X-WP-Nonce":Ge().nonce},credentials:"same-origin",...t},r=await fetch(e,s);if(!r.ok){const e=await r.text();throw new Error(`API Error ${r.status}: ${r.statusText} - ${e}`)}return r}catch(e){throw console.error("API Request Error:",e),e}},$=(0,r.useCallback)(async(e={})=>{const{reset:t=!1,page:s=1,additionalFilters:r={}}=e;try{t&&(m(!0),g(null));const e=Ge(),a=N.current,n=new URLSearchParams({page:s.toString(),per_page:"20",orderby:a.orderBy||"registered",order:a.order||"desc",context:"edit"});a.search&&n.append("search",a.search),a.role&&n.append("roles",a.role),Object.entries(r).forEach(([e,t])=>{null!=t&&""!==t&&n.append(e,t)});const l=`${e.endpoints.users}?${n}`,o=`${l}-${s}-${t}`;if(o===S.current)return void console.log("🚫 Duplicate user request prevented:",l);S.current=o,console.log("🚀 Fetching users:",l);const i=await E(l),c=await i.json();if(!_.current)return;const d=i.headers.get("X-WP-Total"),h=i.headers.get("X-WP-TotalPages"),p={currentPage:s,totalPages:h?parseInt(h,10):1,total:d?parseInt(d,10):c.length,perPage:20};y(p),v(s<p.totalPages);let x=c;a.courseId&&(x=await M(c,a.courseId)),u(t||1===s?x:e=>{const t=new Set(e.map(e=>e.id)),s=x.filter(e=>!t.has(e.id));return[...e,...s]}),console.log("✅ Users loaded:",x.length)}catch(e){console.error("❌ Error fetching users:",e),_.current&&(g(e.message||"Failed to fetch users"),(t||1===s)&&(u([]),y({currentPage:1,totalPages:1,total:0,perPage:20}),v(!1)))}finally{_.current&&m(!1)}},[]),M=async(e,t)=>{try{const s=Ge(),r=e.map(async e=>{try{const r=await E(`${s.endpoints.users}/${e.id}?context=edit`),a=await r.json(),n=`_enrolled_course_${t}`,l=a.meta&&a.meta[n];return{...e,enrollmentData:{isEnrolled:!!l,enrollmentDate:l?a.meta[`${n}_date`]:null,progress:a.meta[`_course_${t}_progress`]||0,lastActivity:a.meta[`_course_${t}_last_activity`]||null}}}catch(t){return console.warn(`Failed to get enrollment data for user ${e.id}:`,t),{...e,enrollmentData:{isEnrolled:!1,enrollmentDate:null,progress:0,lastActivity:null}}}});return await Promise.all(r)}catch(t){return console.error("Error enriching users with enrollment data:",t),e}},q=(0,r.useCallback)((e={})=>{k.current&&clearTimeout(k.current),k.current=setTimeout(()=>{_.current&&$({reset:!0,...e})},i)},[$,i]);(0,r.useEffect)(()=>{l&&(console.log("🎯 Initial user load"),$({reset:!0}))},[]),(0,r.useEffect)(()=>{j(e=>{const r={...e,search:n||"",role:t,courseId:s,enrollmentStatus:a};return JSON.stringify(r)!==JSON.stringify(e)?r:e})},[n,t,s,a]),(0,r.useEffect)(()=>{l&&(console.log("🔄 User filters changed, debouncing fetch..."),q())},[w,q,l]);const z=(0,r.useCallback)(async(e,t)=>{try{p(!0),g(null);const s=Ge(),r={[`_enrolled_course_${t}`]:!0,[`_enrolled_course_${t}_date`]:(new Date).toISOString(),[`_course_${t}_progress`]:0};console.log("📝 Enrolling user in course:",{userId:e,courseId:t});const a=await E(`${s.endpoints.users}/${e}`,{method:"POST",body:JSON.stringify({meta:r})}),n=await a.json();return u(s=>s.map(s=>s.id===e?{...s,enrollmentData:{...s.enrollmentData,isEnrolled:!0,enrollmentDate:r[`_enrolled_course_${t}_date`],progress:0}}:s)),console.log("✅ User enrolled successfully"),n}catch(e){throw console.error("❌ Error enrolling user:",e),g(e.message||"Failed to enroll user"),e}finally{p(!1)}},[]),P=(0,r.useCallback)(async(e,t)=>{try{p(!0),g(null);const s=Ge();console.log("❌ Unenrolling user from course:",{userId:e,courseId:t});const r=await E(`${s.endpoints.users}/${e}`,{method:"POST",body:JSON.stringify({meta:{[`_enrolled_course_${t}`]:null}})}),a=await r.json();return u(t=>t.map(t=>t.id===e?{...t,enrollmentData:{...t.enrollmentData,isEnrolled:!1,enrollmentDate:null,progress:0}}:t)),console.log("✅ User unenrolled successfully"),a}catch(e){throw console.error("❌ Error unenrolling user:",e),g(e.message||"Failed to unenroll user"),e}finally{p(!1)}},[]),R=(0,r.useCallback)(async(e,t)=>{try{p(!0),g(null);const s=Ge();console.log("👤 Updating user role:",{userId:e,newRole:t});const r=await E(`${s.endpoints.users}/${e}`,{method:"POST",body:JSON.stringify({roles:[t]})}),a=await r.json();return u(t=>t.map(t=>t.id===e?{...t,roles:a.roles}:t)),console.log("✅ User role updated successfully"),a}catch(e){throw console.error("❌ Error updating user role:",e),g(e.message||"Failed to update user role"),e}finally{p(!1)}},[]),T=(0,r.useCallback)(()=>{b&&!d&&$({page:f.currentPage+1,reset:!1})},[b,d,f.currentPage,$]),L=(0,r.useCallback)(()=>{S.current="",$({reset:!0})},[$]),D=(0,r.useMemo)(()=>({totalUsers:c.length,usersByRole:c.reduce((e,t)=>{const s=t.roles?.[0]||"subscriber";return e[s]=(e[s]||0)+1,e},{}),enrolledUsers:c.filter(e=>e.enrollmentData?.isEnrolled).length,unenrolledUsers:c.filter(e=>!e.enrollmentData?.isEnrolled).length,activeUsers:c.filter(e=>{if(!e.enrollmentData?.lastActivity)return!1;const t=new Date;return t.setDate(t.getDate()-30),new Date(e.enrollmentData.lastActivity)>t}).length,averageProgress:c.length>0?Math.round(c.reduce((e,t)=>e+(t.enrollmentData?.progress||0),0)/c.length):0,recentRegistrations:c.filter(e=>{const t=new Date;return t.setDate(t.getDate()-7),new Date(e.date_registered||e.registered)>t}).length}),[c]);return{users:c,loading:d,updating:h,error:x,pagination:f,hasMore:b,filters:w,computed:D,enrollUserInCourse:z,unenrollUserFromCourse:P,updateUserRole:R,refreshUsers:L,loadMoreUsers:T,fetchUsers:q}})({search:o,role:"all"!==e?e:null,courseId:"all"!==s?s:null,enrollmentStatus:"all"!==n?n:null,autoFetch:!0}),{courses:w}=Ze({status:"publish,draft",perPage:100,autoFetch:!0}),j=(0,r.useMemo)(()=>w.filter(e=>e.title&&(e.title.rendered||e.title)).map(e=>({...e,title:e.title.rendered||e.title})),[w]),N=(0,r.useMemo)(()=>["all","administrator","editor","author","contributor","subscriber"],[]),C=(0,r.useMemo)(()=>["all","enrolled","not_enrolled"],[]),k=(0,r.useMemo)(()=>{const e=g.totalUsers||0,t=g.enrolledUsers||0,s=g.activeUsers||0,r=g.averageProgress||0,a=g.recentRegistrations||0,n=g.usersByRole||{};return[{label:"Total Users",value:e,icon:ot,iconColor:"text-blue-500"},{label:"Enrolled Users",value:t,icon:We,iconColor:"text-green-500"},{label:"Active Users",value:s,icon:Jt,iconColor:"text-purple-500"},{label:"Avg. Progress",value:`${r}%`,icon:Ve,iconColor:"text-yellow-500"},{label:"New This Week",value:a,icon:Xt,iconColor:"text-blue-400"},{label:"Administrators",value:n.administrator||0,icon:Yt,iconColor:"text-red-500"}]},[g]),_=(0,r.useCallback)(e=>{t(e)},[]),S=(0,r.useCallback)(e=>{a(e)},[]),E=(0,r.useCallback)(e=>{l(e)},[]),$=(0,r.useCallback)(e=>{i(e.target.value)},[]),M=(0,r.useCallback)(e=>{console.log("View user details:",e.id)},[]),q=(0,r.useCallback)(async(e,t)=>{try{await f(e,t)}catch(e){console.error("Error enrolling user:",e)}},[f]),z=(0,r.useCallback)(async(e,t)=>{try{await y(e,t)}catch(e){console.error("Error unenrolling user:",e)}},[y]),P=(0,r.useCallback)(async(e,t)=>{try{await b(e,t)}catch(e){console.error("Error updating user role:",e)}},[b]),R=(0,r.useCallback)(()=>{const e=[["ID","Name","Email","Role","Registration Date","Enrollment Status","Progress"].join(","),...d.map(e=>[e.id,e.name||e.username,e.email,e.roles?.[0]||"subscriber",e.date_registered||e.registered,e.enrollmentData?.isEnrolled?"Enrolled":"Not Enrolled",e.enrollmentData?.progress||0].join(","))].join("\n"),t=new Blob([e],{type:"text/csv"}),s=window.URL.createObjectURL(t),r=document.createElement("a");r.href=s,r.download="users_export.csv",r.click(),window.URL.revokeObjectURL(s)},[d]),T=(0,r.useCallback)(()=>{i("")},[]),L=(0,r.useCallback)(()=>{t("all"),a("all"),l("all"),i("")},[]);return(0,ut.jsxs)("div",{className:"space-y-6",children:[(0,ut.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,ut.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,ut.jsxs)("div",{children:[(0,ut.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"User Management"}),(0,ut.jsx)("p",{className:"text-gray-600 mt-1",children:"Manage users, enrollments, and permissions"})]}),(0,ut.jsxs)("div",{className:"flex items-center space-x-3",children:[(m||h)&&(0,ut.jsxs)("div",{className:"flex items-center text-sm text-gray-500",children:[(0,ut.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500 mr-2"}),h?"Updating...":"Loading..."]}),(0,ut.jsxs)("button",{onClick:R,disabled:0===d.length,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[(0,ut.jsx)(Kt,{className:"h-4 w-4 mr-2"}),"Export CSV"]}),(0,ut.jsxs)("button",{onClick:v,disabled:m,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[(0,ut.jsx)(Gt,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})]}),(0,ut.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:k.map((e,t)=>{const s=e.icon;return(0,ut.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsx)("div",{className:`flex-shrink-0 ${e.iconColor}`,children:(0,ut.jsx)(s,{className:"h-6 w-6"})}),(0,ut.jsxs)("div",{className:"ml-3",children:[(0,ut.jsx)("p",{className:"text-sm font-medium text-gray-600",children:e.label}),(0,ut.jsx)("p",{className:"text-lg font-semibold text-gray-900",children:e.value})]})]})},t)})})]}),(0,ut.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,ut.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,ut.jsxs)("div",{className:"relative",children:[(0,ut.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,ut.jsx)(Ke,{className:"h-5 w-5 text-gray-400"})}),(0,ut.jsx)("input",{type:"text",placeholder:"Search users...",value:o,onChange:$,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500"}),o&&(0,ut.jsxs)("button",{onClick:T,className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:[(0,ut.jsx)("span",{className:"sr-only",children:"Clear search"}),"×"]})]}),(0,ut.jsx)("select",{value:e,onChange:e=>_(e.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:N.map(e=>(0,ut.jsx)("option",{value:e,children:"all"===e?"All Roles":e.charAt(0).toUpperCase()+e.slice(1)},e))}),(0,ut.jsxs)("select",{value:s,onChange:e=>S(e.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[(0,ut.jsx)("option",{value:"all",children:"All Courses"}),j.map(e=>(0,ut.jsx)("option",{value:e.id.toString(),children:e.title},e.id))]}),(0,ut.jsx)("select",{value:n,onChange:e=>E(e.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:C.map(e=>(0,ut.jsx)("option",{value:e,children:"all"===e?"All Statuses":"enrolled"===e?"Enrolled":"not_enrolled"===e?"Not Enrolled":e},e))})]}),(0,ut.jsx)("div",{className:"mt-4 flex justify-end",children:(0,ut.jsx)("button",{onClick:L,className:"px-3 py-1 text-sm text-gray-600 hover:text-gray-900",children:"Clear All Filters"})})]}),"all"!==s&&(0,ut.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:(0,ut.jsxs)("div",{className:"flex items-center",children:[(0,ut.jsx)(rt,{className:"h-5 w-5 text-yellow-600 mr-2"}),(0,ut.jsxs)("div",{className:"flex-1",children:[(0,ut.jsx)("h3",{className:"text-sm font-medium text-yellow-800",children:"Course Management Mode"}),(0,ut.jsxs)("p",{className:"text-sm text-yellow-700 mt-1",children:["You're viewing users in the context of: ",j.find(e=>e.id.toString()===s)?.title]})]})]})}),(0,ut.jsx)(bt,{items:d,loading:m,error:p,pagination:x,viewMode:c,onViewModeChange:u,renderCard:e=>(0,ut.jsx)(rs,{user:e,onView:M,onEnroll:q,onUnenroll:z,onUpdateRole:P,showEnrollment:"all"!==s,courseId:"all"!==s?s:null,viewMode:c},e.id),emptyState:{icon:ot,title:"No users found",description:"No users match your current filters. Try adjusting your search or filter criteria.",actionLabel:"Clear Filters",onAction:L}})]})},ns=function(){return(0,ut.jsx)(ze,{children:(0,ut.jsx)("div",{className:"qe-lms-admin-app",children:(0,ut.jsxs)(ue,{children:[(0,ut.jsx)(ie,{path:"/courses",element:(0,ut.jsx)(Nt,{})}),(0,ut.jsx)(ie,{path:"/lessons",element:(0,ut.jsx)(Dt,{})}),(0,ut.jsx)(ie,{path:"/quizzes",element:(0,ut.jsx)(Ht,{})}),(0,ut.jsx)(ie,{path:"/questions",element:(0,ut.jsx)(Bt,{})}),(0,ut.jsx)(ie,{path:"/students",element:(0,ut.jsx)(as,{})}),(0,ut.jsx)(ie,{path:"/settings",element:(0,ut.jsx)("h1",{children:"Página de Ajustes (Próximamente)"})}),(0,ut.jsx)(ie,{path:"*",element:(0,ut.jsx)(oe,{to:"/courses",replace:!0})})]})})})},ls=document.getElementById("root");n.createRoot(ls).render((0,ut.jsx)(a().StrictMode,{children:(0,ut.jsx)(ns,{})}))})();